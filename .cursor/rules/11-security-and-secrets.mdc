---
description: Secrets management, token handling, CORS, and logging hygiene
globs: ["back/**/*.py", "front/src/api/**/*.js", "front/src/config/**/*.js"]
alwaysApply: true
---

- Secrets and tokens
  - Do not hardcode third-party tokens in source. Move Bosta tokens to server-side environment variables and never expose them in the frontend bundle.
  - Frontend must never call third-party APIs that require secrets; add a backend proxy endpoint if needed.

- Configuration
  - Read database credentials and tokens from environment in `back/config/config.py`. Never log credentials.
  - Keep CORS restricted in `back/app.py` (`allowed_origins`). Add domains explicitly as needed.

- Logging and PII
  - Do not log full external payloads or customer PII in production. Mask or omit sensitive fields.
  - Prefer structured logging with levels over bare `print`.

- Error surfaces
  - Return generic messages to clients; include details only in server logs.

These rules reduce security risk and keep deployments compliant.

