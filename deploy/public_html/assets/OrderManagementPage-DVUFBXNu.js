import{j as r}from"./ui-Cl6mzRtC.js";import{b as N}from"./vendor-D_QXTwu-.js";import{_ as wr}from"./index-C6KfzF9z.js";const jr=({children:t,variant:e="default",size:s="md",className:n="",...a})=>{const o="inline-flex items-center justify-center font-medium rounded-full transition-all duration-200",c={default:"bg-gray-100 text-gray-800 border border-gray-200",primary:"bg-blue-100 text-blue-800 border border-blue-200",success:"bg-green-100 text-green-800 border border-green-200",warning:"bg-yellow-100 text-yellow-800 border border-yellow-200",danger:"bg-red-100 text-red-800 border border-red-200",info:"bg-cyan-100 text-cyan-800 border border-cyan-200",shipping:"bg-purple-100 text-purple-800 border border-purple-200",maintenance:"bg-orange-100 text-orange-800 border border-orange-200",completed:"bg-emerald-100 text-emerald-800 border border-emerald-200",failed:"bg-rose-100 text-rose-800 border border-rose-200",pending:"bg-slate-100 text-slate-800 border border-slate-200",processing:"bg-indigo-100 text-indigo-800 border border-indigo-200"},l={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"};return r.jsx("span",{className:`${o} ${c[e]} ${l[s]} ${n}`,...a,children:t})},xt=(t,e=!0)=>{if(!t||t===null||t===void 0)return e?"لا يوجد تاريخ ووقت":"لا يوجد تاريخ";const s=new Date(t);if(isNaN(s.getTime()))return console.warn("Invalid date format:",t),e?"تاريخ ووقت غير صحيح":"تاريخ غير صحيح";const n=s.getDate(),a=s.getMonth()+1,o=s.getFullYear(),c={0:"٠",1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩"},l=x=>x.toString().split("").map(w=>c[w]||w).join(""),f=`${l(n)}/${l(a)}/${l(o)}`;if(!e)return f;const m=s.getHours(),h=s.getMinutes(),p=m<12?"م":"ص",y=m===0?12:m>12?m-12:m,_=`${l(y)}:${l(h.toString().padStart(2,"0"))} ${p}`;return`${f} ${_}`},bt=t=>{if(!t||t===null||t===void 0)return"لا يوجد وقت";const e=new Date(t);if(isNaN(e.getTime()))return console.warn("Invalid date format:",t),"وقت غير صحيح";const s={0:"٠",1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩"},n=f=>f.toString().split("").map(m=>s[m]||m).join(""),a=e.getHours(),o=e.getMinutes(),c=a<12?"م":"ص",l=a===0?12:a>12?a-12:a;return`${n(l)}:${n(o.toString().padStart(2,"0"))} ${c}`},Lt=t=>{if(!t||t===null||t===void 0)return"لا يوجد تاريخ";const e=new Date(t);if(isNaN(e.getTime()))return console.warn("Invalid date format:",t),"تاريخ غير صحيح";const s={0:"٠",1:"١",2:"٢",3:"٣",4:"٤",5:"٥",6:"٦",7:"٧",8:"٨",9:"٩"},n=l=>l.toString().split("").map(f=>s[f]||f).join(""),a=e.getDate(),o=e.getMonth()+1,c=e.getFullYear();return`${n(a)}/${n(o)}/${n(c)}`},Nr=({order:t,onAction:e,actions:s=[],showTimeline:n=!1,onShowTimeline:a,className:o="",...c})=>{var Ve;const[l,f]=N.useState(!1),[m,h]=N.useState(""),[p,y]=N.useState(!1),[_,x]=N.useState(null),[w,b]=N.useState(!1),L=(()=>{var g;const i=(g=t.maintenanceHistory)==null?void 0:g.find(O=>(O.action==="refund_or_replace"||O.action==="confirm_send"||O.action==="send_order")&&O.actionData);return(i==null?void 0:i.actionData)||{}})(),[E,D]=N.useState(L.newTrackingNumber||""),[I,q]=N.useState(L.newCod||""),[te,ae]=N.useState(L.refundAmount||""),[he,U]=N.useState(L.refundReason||""),[fe,_e]=N.useState(L.replacementTrackingNumber||""),pe=()=>t.status==="sending",Q=()=>{var i;return(i=t.maintenanceHistory)==null?void 0:i.some(g=>g.action==="confirm_send"&&g.actionData)},oe=()=>{var i;return(i=t.maintenanceHistory)==null?void 0:i.some(g=>g.action==="send_order"&&g.actionData)},Tt=()=>{var i;return(i=t.maintenanceHistory)==null?void 0:i.some(g=>g.action==="confirm_refund_replace"&&g.actionData)},Ot=()=>{var i;return(i=t.maintenanceHistory)==null?void 0:i.some(g=>g.action==="refund_or_replace"&&g.actionData)},ge=()=>{var g;if(!pe())return null;const i=(g=t.maintenanceHistory)==null?void 0:g.find(O=>(O.action==="refund_or_replace"||O.action==="confirm_send"||O.action==="send_order"||O.action==="confirm_refund_replace")&&O.action_data);return(i==null?void 0:i.action_data)||{}},Ee=()=>{var g;const i=(g=t.maintenanceHistory)==null?void 0:g.find(O=>(O.action==="refund_or_replace"||O.action==="send_order"||O.action==="confirm_send")&&O.action_data);return console.log("Order maintenance history:",t.maintenanceHistory),console.log("Latest action found:",i),console.log("Action data:",i==null?void 0:i.action_data),(i==null?void 0:i.action_data)||{}},A=(i=>{var $,P,M,K,le,Se,Je,Qe,Ke,Ge,Ae,Me,De,Pe,$e,Be;const g=()=>{var u,v,C,j;return(v=(u=i.returnSpecs)==null?void 0:u.packageDetails)!=null&&v.description?i.returnSpecs.packageDetails.description:(j=(C=i.specs)==null?void 0:C.packageDetails)!=null&&j.description?i.specs.packageDetails.description:i.description?i.description:"لا يوجد وصف"},O=()=>{var u,v,C,j,B;return((u=i.type)==null?void 0:u.value)==="Customer Return Pickup"&&i.pickupAddress?`${i.pickupAddress.firstLine||""} - ${((v=i.pickupAddress.zone)==null?void 0:v.nameAr)||""}, ${((C=i.pickupAddress.city)==null?void 0:C.nameAr)||""}`.trim():i.dropOffAddress?`${i.dropOffAddress.firstLine||""} ${i.dropOffAddress.secondLine||""} - ${((j=i.dropOffAddress.zone)==null?void 0:j.nameAr)||""}, ${((B=i.dropOffAddress.city)==null?void 0:B.nameAr)||""}`.trim():i.address||""};return{trackingNumber:i.trackingNumber||i.tracking_number,description:g(),shippingState:i.maskedState||(($=i.state)==null?void 0:$.value)||i.status,cod:i.cod||0,bostaFees:((M=(P=i.wallet)==null?void 0:P.cashCycle)==null?void 0:M.bosta_fees)||i.shipmentFees||0,starName:((K=i.star)==null?void 0:K.name)||"غير محدد",starPhone:((le=i.star)==null?void 0:le.phone)||"",itemsCount:((Je=(Se=i.specs)==null?void 0:Se.packageDetails)==null?void 0:Je.itemsCount)||((Ke=(Qe=i.returnSpecs)==null?void 0:Qe.packageDetails)==null?void 0:Ke.itemsCount)||1,weight:((Ge=i.specs)==null?void 0:Ge.weight)||0,proofImages:i.starProofOfReturnedPackages||[],returnReason:((Me=(Ae=i.returnSpecs)==null?void 0:Ae.packageDetails)==null?void 0:Me.description)||"",isReturn:((De=i.type)==null?void 0:De.value)==="Customer Return Pickup",attemptsCount:i.attemptsCount||0,callsNumber:i.callsNumber||0,smsNumber:i.smsNumber||0,receiver:{fullName:((Pe=i.receiver)==null?void 0:Pe.fullName)||"",phone:(($e=i.receiver)==null?void 0:$e.phone)||"",secondPhone:((Be=i.receiver)==null?void 0:Be.secondPhone)||""},address:{full:O()},timeline:i.timeline||[]}})(t),Oe=i=>({scanned:"info",received:"primary",in_maintenance:"warning",completed:"success",failed:"danger",returned:"secondary",sending:"shipping",rescheduled:"info",Delivered:"success",Returned:"secondary","In Transit":"info","Out for Delivery":"warning","Picked Up":"primary"})[i]||"default",S=i=>({scanned:"تم المسح",received:"مستلم",in_maintenance:"تحت الصيانة",completed:"مكتمل",failed:"فاشل",returned:"مرتجع",sending:"جاري الإرسال",rescheduled:"إعادة جدولة",Delivered:"تم التوصيل",Returned:"تم الإرجاع","In Transit":"في الطريق","Out for Delivery":"خارج للتوصيل","Picked Up":"تم الاستلام"})[i]||i,We=i=>{var O,$;const g=i.maintenanceHistory||[];return g[g.length-1],i.status==="completed"&&g.some(P=>P.action==="send_order")?{label:"تم الإصلاح",variant:"success",icon:"success"}:i.status==="completed"&&g.some(P=>P.action==="refund_or_replace")&&!g.some(P=>P.action==="confirm_refund_replace")?{label:"تحضير الاسترداد أو الإرسال",variant:"warning",icon:"warning"}:i.status==="completed"&&!g.some(P=>P.action==="send_order")?{label:"تم الإصلاح",variant:"success",icon:"success"}:i.status==="in_maintenance"&&g.some(P=>P.action==="fail_maintenance")?{label:"إعادة صيانة",variant:"warning",icon:"refresh"}:i.status==="received"&&g.some(P=>P.action==="fail_maintenance")?{label:"إعادة صيانة",variant:"info",icon:"refresh"}:i.status==="failed"?{label:"فشل الصيانة",variant:"danger",icon:"warning"}:g.some(P=>P.action==="return_order")?{label:"مرتجع للعميل",variant:"secondary",icon:"return"}:i.status==="sending"?((O=i.maintenanceHistory)==null?void 0:O.some(K=>K.action==="refund_or_replace"&&K.actionData))?{label:"تم استرداد او ارسال",variant:"success",icon:"success"}:(($=i.maintenanceHistory)==null?void 0:$.some(K=>K.action==="confirm_send"&&K.actionData))?{label:"تم الإرسال",variant:"success",icon:"success"}:{label:"تم الإرسال",variant:"success",icon:"success"}:i.status==="failed"&&g.some(P=>P.action==="refund_or_replace")?{label:"تم الاسترداد",variant:"success",icon:"success"}:A.shippingState==="Returned"||A.isReturn?{label:A.isReturn?"استرجاع عميل":"تم الإرجاع",variant:"secondary",icon:"return"}:null},Z=i=>{var O,$,P;const g=[];if(We(i),pe())return[];switch(i.status){case"received":g.push({type:"start_maintenance",label:"بدء الصيانة",className:"bg-blue-600 hover:bg-blue-700 text-white",priority:"primary"},{type:"move_to_returns",label:"نقل للمرتجعات",className:"bg-orange-600 hover:bg-orange-700 text-white",priority:"secondary"});break;case"in_maintenance":g.push({type:"complete_maintenance",label:"إنجاز الصيانة",className:"bg-green-600 hover:bg-green-700 text-white",priority:"primary"},{type:"fail_maintenance",label:"فشل الصيانة",className:"bg-red-600 hover:bg-red-700 text-white",priority:"secondary"});break;case"failed":g.push({type:"reschedule",label:"إعادة للصيانة",className:"bg-yellow-600 hover:bg-yellow-700 text-white",priority:"primary"},{type:"refund_or_replace",label:"استرداد أو إرسال منتج آخر",className:"bg-orange-600 hover:bg-orange-700 text-white",priority:"secondary",requiresInput:!1});break;case"completed":((O=i.maintenanceHistory)==null?void 0:O.some(le=>le.action==="refund_or_replace"))&&!(($=i.maintenanceHistory)!=null&&$.some(le=>le.action==="send_order"))?g.push({type:"send_order",label:"إرسال للعميل",className:"bg-purple-600 hover:bg-purple-700 text-white",priority:"primary",requiresInput:!0}):((P=i.maintenanceHistory)==null?void 0:P.some(Se=>Se.action==="send_order"))?g.push({type:"confirm_send",label:"تأكيد الإرسال للعميل",className:"bg-purple-600 hover:bg-purple-700 text-white",priority:"primary",requiresInput:!0}):g.push({type:"send_order",label:"إرسال للعميل",className:"bg-purple-600 hover:bg-purple-700 text-white",priority:"primary",requiresInput:!0});break}return g},re=i=>xt(i,!0),lt=i=>{var $,P;const g=(($=A.timeline)==null?void 0:$.map(M=>(M.date||console.warn("Timeline item missing date:",M),{title:xe(M.value),description:`حالة الشحن: ${xe(M.value)}`,time:bt(M.date),date:Lt(M.date),status:M.done?"completed":"pending",details:`كود الحالة: ${M.code}`})))||[],O=((P=i.maintenanceHistory)==null?void 0:P.map(M=>(M.timestamp||console.warn("Maintenance item missing timestamp:",M),{title:ue(M.action),description:M.notes,time:bt(M.timestamp),date:Lt(M.timestamp),status:"maintenance",details:`بواسطة: ${M.user}`,user:M.user})))||[];return[...g,...O].sort((M,K)=>new Date(K.timestamp||K.date)-new Date(M.timestamp||M.date))},xe=i=>({ready_for_pickup:"جاهز للاستلام",picked_up:"تم الاستلام",in_transit:"في الطريق",out_for_delivery:"خارج للتوصيل",delivered:"تم التوصيل",returned:"تم الإرجاع",out_for_return:"خارج للإرجاع"})[i]||i,ue=i=>({received:"تم الاستلام في المركز",start_maintenance:"بدء الصيانة",complete_maintenance:"انتهاء الصيانة",fail_maintenance:"فشل الصيانة",send_order:"إرسال الطلب للعميل",return_order:"إرجاع الطلب للعميل",reschedule:"إعادة للصيانة",refund_or_replace:"استرداد أو إرسال منتج آخر",move_to_returns:"نقل للمرتجعات",confirm_send:"تأكيد الإرسال للعميل",confirm_refund_replace:"تأكيد الاسترداد أو الإرسال"})[i]||i,qe=i=>({start_maintenance:r.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),complete_maintenance:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),fail_maintenance:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),send_order:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),return_order:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),reschedule:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),refund_or_replace:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),move_to_returns:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),confirm_send:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),confirm_refund_replace:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})[i]||null,Le=i=>({warning:r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),refresh:r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),return:r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),success:r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),shipping:r.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})[i]||null,be=i=>({received:r.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),start_maintenance:r.jsx("div",{className:"w-6 h-6 bg-green-100 rounded-full flex items-center justify-center",children:r.jsxs("svg",{className:"w-3 h-3 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),fail_maintenance:r.jsx("div",{className:"w-6 h-6 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),reschedule:r.jsx("div",{className:"w-6 h-6 bg-yellow-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),complete_maintenance:r.jsx("div",{className:"w-6 h-6 bg-green-600 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),send_order:r.jsx("div",{className:"w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})}),return_order:r.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),refund_or_replace:r.jsx("div",{className:"w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),move_to_returns:r.jsx("div",{className:"w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})})}),confirm_send:r.jsx("div",{className:"w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),confirm_refund_replace:r.jsx("div",{className:"w-6 h-6 bg-orange-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})})[i]||r.jsx("div",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),ke=async(i,g,O)=>{if(!p){y(!0);try{if(i==="confirm_send"){const $={notes:O,new_tracking_number:E,new_cod:I||null};await(e==null?void 0:e(i,g,$)),D(""),q("")}else if(i==="refund_or_replace"){const $={notes:O,new_tracking_number:E||null,new_cod:I||null};await(e==null?void 0:e(i,g,$)),D(""),q("")}else if(i==="confirm_refund_replace"){const $={notes:O,refund_amount:te,refund_reason:he,replacement_tracking_number:fe||null,new_tracking_number:E,new_cod:I||null};await(e==null?void 0:e(i,g,$)),ae(""),U(""),_e(""),D(""),q("")}else if(i==="send_order"){const $={notes:O,new_tracking_number:E,new_cod:I||null};await(e==null?void 0:e(i,g,$)),D(""),q("")}else await(e==null?void 0:e(i,g,O));h("")}catch($){console.error("Action failed:",$)}finally{y(!1)}}},me=Z(t),ce=We(t);return r.jsxs("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-200 ${o}`,...c,children:[r.jsx("div",{className:"p-3 border-b border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-cairo font-bold text-gray-900",children:r.jsx("a",{href:`https://business.bosta.co/orders/${A.trackingNumber}`,target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 hover:underline transition-colors duration-200 cursor-pointer",title:"فتح في بوابة بوسطا للأعمال",children:A.trackingNumber})}),r.jsx("p",{className:"text-xs text-gray-600 font-cairo",children:A.receiver.fullName})]})]}),r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[ce&&r.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-cairo font-medium flex items-center space-x-1 space-x-reverse ${ce.variant==="danger"?"bg-red-100 text-red-800":ce.variant==="info"?"bg-blue-100 text-blue-800":ce.variant==="secondary"?"bg-gray-100 text-gray-800":ce.variant==="success"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:[Le(ce.icon),r.jsx("span",{children:ce.label})]}),r.jsx(jr,{variant:Oe(t.status),size:"sm",children:S(t.status)}),r.jsx("button",{onClick:()=>f(!l),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors","aria-label":l?"تصغير التفاصيل":"توسيع التفاصيل",children:r.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${l?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),r.jsxs("div",{className:"px-3 py-2 bg-gray-50",children:[A.description&&A.description!=="لا يوجد وصف"&&r.jsxs("div",{className:"mb-2",children:[r.jsx("span",{className:"text-gray-500 font-cairo text-xs block mb-1",children:A.isReturn?"وصف المنتج المسترجع":"وصف المنتج"}),r.jsx("p",{className:"font-cairo text-xs text-gray-900 leading-relaxed bg-white rounded p-2 border-r-2 border-blue-200",children:A.description})]}),t.status==="sending"&&(()=>{const i=Ee();return!i||!i.new_tracking_number&&!i.new_cod&&!i.notes?null:r.jsxs("div",{className:"mb-2",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full animate-pulse"}),r.jsx("span",{className:"text-gray-500 font-cairo text-xs font-medium",children:"بيانات الإرسال"})]}),r.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3 border border-blue-200/50 shadow-sm",children:[r.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[i.new_tracking_number&&r.jsxs("div",{className:"flex items-center justify-between bg-white/80 backdrop-blur-sm rounded-md p-2 border border-blue-200/30 hover:border-blue-300/50 transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم التتبع"})]}),r.jsx("a",{href:`https://business.bosta.co/orders/${i.new_tracking_number}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-cairo font-semibold text-blue-700 bg-blue-50 px-2 py-1 rounded-md hover:bg-blue-100 hover:text-blue-800 transition-all duration-200 cursor-pointer",title:"فتح في بوابة بوسطا للأعمال",children:i.new_tracking_number})]}),i.new_cod&&r.jsxs("div",{className:"flex items-center justify-between bg-white/80 backdrop-blur-sm rounded-md p-2 border border-green-200/30 hover:border-green-300/50 transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"المبلغ"})]}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700 bg-green-50 px-2 py-1 rounded-md",children:[i.new_cod," ج.م"]})]}),i.notes&&r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-md p-2 border border-purple-200/30 hover:border-purple-300/50 transition-all duration-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-1",children:[r.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"ملاحظات"})]}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed bg-purple-50/50 px-2 py-1 rounded-md",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]}),r.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200/30",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[r.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full animate-ping"}),r.jsx("span",{className:"text-xs font-cairo text-blue-600 font-medium",children:"جاهز للإرسال"})]}),r.jsxs("div",{className:"flex space-x-1 space-x-reverse",children:[r.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full"}),r.jsx("div",{className:"w-1 h-1 bg-purple-400 rounded-full"}),r.jsx("div",{className:"w-1 h-1 bg-green-400 rounded-full"})]})]})})]})]})})(),A.proofImages&&A.proofImages.length>0&&r.jsxs("div",{className:"mb-2",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsxs("span",{className:"text-gray-500 font-cairo text-xs",children:["صور المندوب للمرتجع (",A.proofImages.length,")"]})}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:A.proofImages.slice(0,3).map((i,g)=>r.jsxs("div",{className:"relative group",children:[r.jsx("img",{src:i,alt:`إثبات ${g+1}`,className:"w-full h-12 object-cover rounded-lg border border-gray-200 cursor-pointer hover:scale-105 transition-transform duration-200 hover:shadow-md",onClick:()=>window.open(i,"_blank"),title:"انقر لفتح الصورة في نافذة جديدة"}),r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 rounded-lg transition-opacity duration-200 flex items-center justify-center",children:r.jsx("svg",{className:"w-3 h-3 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]},g))})]}),t.maintenanceHistory&&t.maintenanceHistory.length>0&&r.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[r.jsx("span",{className:"text-xs text-gray-500 font-cairo",children:"دورة الصيانة:"}),r.jsx("div",{className:"flex items-center space-x-1 space-x-reverse relative",children:t.maintenanceHistory.slice().reverse().map((i,g)=>r.jsxs("div",{className:"relative group",children:[r.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse cursor-pointer transition-all duration-200 hover:scale-110 hover:bg-blue-50 rounded-lg p-1",onMouseEnter:()=>x(i),onMouseLeave:()=>x(null),onClick:()=>a==null?void 0:a(t),children:[r.jsx("div",{className:"transition-all duration-200 group-hover:scale-110 group-hover:shadow-sm",children:be(i.action)}),g<t.maintenanceHistory.length-1&&r.jsx("div",{className:"w-3 h-0.5 bg-gray-300 mx-1 transition-colors duration-200 group-hover:bg-blue-300"})]}),_===i&&r.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 z-[9999] pointer-events-none",children:r.jsxs("div",{className:"bg-white text-gray-900 rounded-lg p-3 shadow-xl border border-gray-200 min-w-[220px] max-w-[280px] backdrop-blur-sm",children:[r.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-b-4 border-transparent border-b-white"}),r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center",children:be(i.action)}),r.jsx("h4",{className:"font-cairo font-semibold text-sm text-gray-900",children:ue(i.action)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("p",{className:"text-xs text-gray-600 font-cairo leading-relaxed",children:i.notes}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 font-cairo",children:[r.jsxs("span",{children:["بواسطة: ",i.user]}),r.jsx("span",{children:re(i.timestamp)})]})]}),r.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-between text-xs",children:[r.jsxs("span",{className:"text-gray-500 font-cairo",children:["الخطوة ",t.maintenanceHistory.length-g," من ",t.maintenanceHistory.length]}),r.jsx("div",{className:"flex space-x-1 space-x-reverse",children:t.maintenanceHistory.slice().reverse().map((O,$)=>r.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${$<=g?"bg-blue-500":"bg-gray-300"}`},$))})]})})]})})]},g))})]})]}),me.length>0&&r.jsxs("div",{className:"p-3 bg-white border-t border-gray-100",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),r.jsx("span",{className:"text-xs font-cairo font-medium text-gray-700",children:"إجراءات الطلب"})]}),r.jsx("div",{className:`grid gap-2 ${me.length===1?"grid-cols-1":"grid-cols-2"}`,children:me.map((i,g)=>r.jsxs("button",{onClick:()=>ke(i.type,t,m),disabled:i.disabled||p,className:`
                  relative group px-3 py-2 rounded-md font-cairo text-xs font-medium transition-all duration-200
                  flex items-center justify-center space-x-1 space-x-reverse
                  ${i.className}
                  ${i.disabled||p?"opacity-50 cursor-not-allowed":"hover:scale-105 hover:shadow-sm"}
                  focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500
                `,"aria-label":i.label,children:[p&&r.jsx("div",{className:"absolute inset-0 bg-white/80 rounded-md flex items-center justify-center",children:r.jsxs("svg",{className:"w-3 h-3 animate-spin text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),qe(i.type)&&r.jsx("span",{className:"transition-transform duration-200 group-hover:scale-110",children:qe(i.type)}),r.jsx("span",{className:"font-cairo",children:i.label})]},g))}),r.jsxs("div",{className:"mt-2 space-y-2",children:[me.some(i=>(i.type==="confirm_send"||i.type==="send_order"||i.type==="refund_or_replace")&&i.requiresInput)&&r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"رقم التتبع الجديد"}),r.jsx("input",{type:"text",value:E,onChange:i=>D(i.target.value),placeholder:"أدخل رقم التتبع الجديد",className:`w-full px-2 py-1 border rounded-md font-cairo text-xs text-right ${Q()||oe()?"border-gray-200 bg-gray-50 text-gray-600 cursor-not-allowed":"border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-transparent"}`,dir:"rtl",readOnly:Q()||oe(),disabled:Q()||oe()})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"المبلغ المستحق (اختياري)"}),r.jsx("input",{type:"number",value:I,onChange:i=>q(i.target.value),placeholder:"أدخل المبلغ",className:`w-full px-2 py-1 border rounded-md font-cairo text-xs text-right ${Q()||oe()?"border-gray-200 bg-gray-50 text-gray-600 cursor-not-allowed":"border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-transparent"}`,dir:"rtl",readOnly:Q()||oe(),disabled:Q()||oe()})]})]}),me.some(i=>i.type==="confirm_refund_replace"&&i.requiresInput)&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"مبلغ الاسترداد"}),r.jsx("input",{type:"number",value:te,onChange:i=>ae(i.target.value),placeholder:"أدخل مبلغ الاسترداد",className:"w-full px-2 py-1 border border-gray-300 rounded-md font-cairo text-xs text-right focus:ring-1 focus:ring-orange-500 focus:border-transparent",dir:"rtl"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"رقم تتبع المنتج البديل (اختياري)"}),r.jsx("input",{type:"text",value:fe,onChange:i=>_e(i.target.value),placeholder:"أدخل رقم التتبع",className:"w-full px-2 py-1 border border-gray-300 rounded-md font-cairo text-xs text-right focus:ring-1 focus:ring-orange-500 focus:border-transparent",dir:"rtl"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"رقم التتبع الجديد"}),r.jsx("input",{type:"text",value:E,onChange:i=>D(i.target.value),placeholder:"أدخل رقم التتبع الجديد",className:"w-full px-2 py-1 border border-gray-300 rounded-md font-cairo text-xs text-right focus:ring-1 focus:ring-orange-500 focus:border-transparent",dir:"rtl"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-cairo text-gray-700 mb-1",children:"المبلغ المستحق (اختياري)"}),r.jsx("input",{type:"number",value:I,onChange:i=>q(i.target.value),placeholder:"أدخل المبلغ",className:"w-full px-2 py-1 border border-gray-300 rounded-md font-cairo text-xs text-right focus:ring-1 focus:ring-orange-500 focus:border-transparent",dir:"rtl"})]})]})]}),Ot()&&r.jsxs("div",{className:"bg-green-50 rounded-md p-3 border border-green-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-green-700",children:"تم الإرسال - بيانات الإجراء"})]}),(()=>{const i=ge();return i?r.jsxs("div",{className:"space-y-2",children:[i.refundAmount&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-green-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"مبلغ الاسترداد:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700",children:[i.refundAmount," ج.م"]})]}),i.replacementTrackingNumber&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-green-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم تتبع المنتج البديل:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:i.replacementTrackingNumber})]}),i.notes&&r.jsxs("div",{className:"bg-white rounded p-2 border border-green-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600 block mb-1",children:"ملاحظات:"}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]}):null})()]}),Q()&&r.jsxs("div",{className:"bg-blue-50 rounded-md p-3 border border-blue-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:"تم الإرسال - بيانات الإجراء"})]}),(()=>{const i=ge();return i?r.jsxs("div",{className:"space-y-2",children:[i.new_tracking_number&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم التتبع الجديد:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:i.new_tracking_number})]}),i.new_cod&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"المبلغ المستحق:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700",children:[i.new_cod," ج.م"]})]}),i.notes&&r.jsxs("div",{className:"bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600 block mb-1",children:"ملاحظات:"}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]}):null})()]}),oe()&&r.jsxs("div",{className:"bg-purple-50 rounded-md p-3 border border-purple-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-purple-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-purple-700",children:"تم الإرسال للعميل - بيانات الإجراء"})]}),(()=>{const i=ge();return i?r.jsxs("div",{className:"space-y-2",children:[i.new_tracking_number&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-purple-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم التتبع الجديد:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-purple-700",children:i.new_tracking_number})]}),i.new_cod&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-purple-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"المبلغ المستحق:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700",children:[i.new_cod," ج.م"]})]}),i.notes&&r.jsxs("div",{className:"bg-white rounded p-2 border border-purple-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600 block mb-1",children:"ملاحظات:"}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]}):null})()]}),Tt()&&r.jsxs("div",{className:"bg-orange-50 rounded-md p-3 border border-orange-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-orange-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-orange-700",children:"تم الاسترداد أو الإرسال - بيانات الإجراء"})]}),(()=>{const i=ge();return i?r.jsxs("div",{className:"space-y-2",children:[i.refundAmount&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-orange-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"مبلغ الاسترداد:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-orange-700",children:[i.refundAmount," ج.م"]})]}),i.replacementTrackingNumber&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-orange-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم تتبع المنتج البديل:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:i.replacementTrackingNumber})]}),i.new_tracking_number&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-orange-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم التتبع الجديد:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:i.new_tracking_number})]}),i.new_cod&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-orange-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"المبلغ المستحق:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700",children:[i.new_cod," ج.م"]})]}),i.notes&&r.jsxs("div",{className:"bg-white rounded p-2 border border-orange-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600 block mb-1",children:"ملاحظات:"}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]}):null})()]}),t.status==="sending"&&r.jsxs("div",{className:"bg-blue-50 rounded-md p-3 border border-blue-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse mb-2",children:[r.jsx("div",{className:"w-4 h-4 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-2 h-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:"بيانات الإرسال"})]}),(()=>{const i=Ee();return!i||!i.new_tracking_number&&!i.new_cod&&!i.notes?null:r.jsxs("div",{className:"space-y-2",children:[i.new_tracking_number&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"رقم التتبع الجديد:"}),r.jsx("span",{className:"text-xs font-cairo font-semibold text-blue-700",children:i.new_tracking_number})]}),i.new_cod&&r.jsxs("div",{className:"flex items-center justify-between bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600",children:"المبلغ المستحق:"}),r.jsxs("span",{className:"text-xs font-cairo font-semibold text-green-700",children:[i.new_cod," ج.م"]})]}),i.notes&&r.jsxs("div",{className:"bg-white rounded p-2 border border-blue-200",children:[r.jsx("span",{className:"text-xs font-cairo text-gray-600 block mb-1",children:"ملاحظات:"}),r.jsx("p",{className:"text-xs font-cairo text-gray-700 leading-relaxed",children:typeof i.notes=="string"?i.notes:JSON.stringify(i.notes)})]})]})})()]}),r.jsx("textarea",{value:m,onChange:i=>h(i.target.value),placeholder:"ملاحظات (اختيارية)...",rows:2,className:`w-full px-2 py-1 border rounded-md font-cairo text-xs text-right resize-none transition-all duration-200 min-h-[3rem] ${pe()?"border-gray-200 bg-gray-50 text-gray-600 cursor-not-allowed":"border-gray-300 focus:ring-1 focus:ring-blue-500 focus:border-transparent"}`,dir:"rtl",readOnly:pe(),disabled:pe()})]})]}),l&&r.jsxs("div",{className:"p-3 space-y-3 border-t border-gray-100",children:[r.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[r.jsx("h4",{className:"font-cairo font-semibold text-gray-900 mb-2 text-sm",children:"تفاصيل الطلب والشحن"}),r.jsxs("div",{className:"grid grid-cols-1 gap-3 text-xs",children:[r.jsxs("div",{className:"bg-white rounded p-2",children:[r.jsx("h5",{className:"font-cairo font-medium text-gray-800 mb-2",children:"معلومات الشحن والاتصال"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"رقم التتبع:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:A.trackingNumber})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"حالة الشحن:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:S(A.shippingState)})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"نوع الطرد:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:((Ve=t.type)==null?void 0:Ve.value)||"غير محدد"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"التاريخ:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:re(t.createdAt||t.creationTimestamp)})]}),A.attemptsCount>0&&r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"عدد المحاولات:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:A.attemptsCount})]}),A.callsNumber>0&&r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 font-cairo",children:"عدد المكالمات:"}),r.jsx("p",{className:"font-cairo font-medium mt-1",children:A.callsNumber})]})]})]}),(A.returnReason||A.isReturn)&&r.jsxs("div",{className:"bg-orange-50 rounded p-2 border border-orange-200",children:[r.jsx("h5",{className:"font-cairo font-medium text-orange-800 mb-2",children:A.isReturn?"معلومات الاسترجاع":"سبب الإرجاع"}),A.returnReason&&r.jsx("p",{className:"font-cairo text-orange-700 text-xs leading-relaxed mb-2",children:A.returnReason}),A.isReturn&&r.jsx("div",{className:"text-xs",children:r.jsx("span",{className:"inline-block bg-orange-100 text-orange-800 px-2 py-1 rounded font-cairo",children:"طلب استرجاع من العميل"})})]})]})]}),n&&r.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[r.jsx("h4",{className:"font-cairo font-semibold text-gray-900 mb-2 text-sm",children:"الجدول الزمني"}),r.jsx(Jt,{items:lt(t).slice(0,3),variant:"compact"})]}),t.maintenanceHistory&&t.maintenanceHistory.length>0&&r.jsxs("div",{className:"bg-yellow-50 rounded-md p-3",children:[r.jsx("h4",{className:"font-cairo font-semibold text-gray-900 mb-2 text-sm",children:"دورة الصيانة الكاملة"}),r.jsx("div",{className:"space-y-2",children:t.maintenanceHistory.map((i,g)=>r.jsxs("div",{className:"flex items-start space-x-2 space-x-reverse",children:[r.jsx("div",{className:`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${i.action==="received"?"bg-blue-500":i.action==="start_maintenance"?"bg-green-500":i.action==="fail_maintenance"?"bg-red-500":i.action==="reschedule"?"bg-yellow-500":i.action==="complete_maintenance"?"bg-green-600":i.action==="send_order"?"bg-purple-500":i.action==="return_order"?"bg-gray-500":"bg-yellow-500"}`}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"font-cairo font-medium text-gray-900 text-xs",children:ue(i.action)}),r.jsx("span",{className:"text-xs text-gray-500 font-cairo",children:re(i.timestamp)})]}),r.jsx("p",{className:"text-xs text-gray-600 font-cairo mt-1",children:i.notes}),r.jsxs("p",{className:"text-xs text-gray-500 font-cairo mt-1",children:["بواسطة: ",i.user]})]})]},g))})]})]})]})},Jt=({items:t,variant:e="default",className:s="",...n})=>{const a={default:{container:"relative",item:"relative pb-8",line:"absolute right-4 top-4 w-0.5 h-full bg-gray-200",dot:"absolute right-4 top-4 w-3 h-3 rounded-full border-2 border-white shadow-sm",content:"mr-12"},compact:{container:"relative",item:"relative pb-6",line:"absolute right-3 top-3 w-0.5 h-full bg-gray-200",dot:"absolute right-3 top-3 w-2.5 h-2.5 rounded-full border-2 border-white shadow-sm",content:"mr-8"}},o={completed:"bg-green-500",processing:"bg-blue-500",pending:"bg-yellow-500",failed:"bg-red-500",shipping:"bg-purple-500",maintenance:"bg-orange-500",delivered:"bg-emerald-500",returned:"bg-rose-500"},c=a[e];return r.jsx("div",{className:`${c.container} ${s}`,...n,children:t.map((l,f)=>r.jsxs("div",{className:c.item,children:[f<t.length-1&&r.jsx("div",{className:c.line}),r.jsx("div",{className:`${c.dot} ${o[l.status]||"bg-gray-400"}`}),r.jsxs("div",{className:c.content,children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-cairo-play font-semibold text-gray-900 mb-1",children:l.title}),l.description&&r.jsx("p",{className:"text-gray-600 text-sm mb-2 font-roboto",children:l.description}),l.details&&r.jsx("div",{className:"text-xs text-gray-500 font-roboto",children:l.details})]}),r.jsx("div",{className:"text-right",children:r.jsx("time",{className:"text-xs text-gray-500 font-roboto",children:l.time})})]}),l.actions&&r.jsx("div",{className:"mt-3 flex space-x-2 space-x-reverse",children:l.actions.map((m,h)=>r.jsxs("button",{onClick:m.onClick,className:"inline-flex items-center px-3 py-1.5 text-xs font-medium rounded-md bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors duration-200",children:[m.icon&&r.jsx("span",{className:"ml-1 ml-reverse mr-1",children:m.icon}),m.label]},h))})]})]},f))})};class R{constructor(e,s,n,a,o){this._legacyCanvasSize=R.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=e,this.$canvas=document.createElement("canvas"),n&&typeof n=="object"?this._onDecode=s:(console.warn(n||a||o?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=s),s=typeof n=="object"?n:{},this._onDecodeError=s.onDecodeError||(typeof n=="function"?n:this._onDecodeError),this._calculateScanRegion=s.calculateScanRegion||(typeof a=="function"?a:this._calculateScanRegion),this._preferredCamera=s.preferredCamera||o||this._preferredCamera,this._legacyCanvasSize=typeof n=="number"?n:typeof a=="number"?a:this._legacyCanvasSize,this._maxScansPerSecond=s.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),e.disablePictureInPicture=!0,e.playsInline=!0,e.muted=!0;let c=!1;if(e.hidden&&(e.hidden=!1,c=!0),document.body.contains(e)||(document.body.appendChild(e),c=!0),n=e.parentElement,s.highlightScanRegion||s.highlightCodeOutline){if(a=!!s.overlay,this.$overlay=s.overlay||document.createElement("div"),o=this.$overlay.style,o.position="absolute",o.display="none",o.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!a&&s.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}n.insertBefore(this.$overlay,this.$video.nextSibling)}s.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(e),requestAnimationFrame(()=>{let l=window.getComputedStyle(e);l.display==="none"&&(e.style.setProperty("display","block","important"),c=!0),l.visibility!=="visible"&&(e.style.setProperty("visibility","visible","important"),c=!0),c&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),e.style.opacity="0",e.style.width="0",e.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),e.addEventListener("play",this._onPlay),e.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=R.createQrEngine()}static set WORKER_PATH(e){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await R.listCameras(!1)).length}catch{return!1}}static async listCameras(e=!1){if(!navigator.mediaDevices)return[];let s=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(a=>a.kind==="videoinput"),n;try{e&&(await s()).every(a=>!a.label)&&(n=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await s()).map((a,o)=>({id:a.deviceId,label:a.label||(o===0?"Default Camera":`Camera ${o+1}`)}))}finally{n&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),R._stopVideoStream(n))}}async hasFlash(){let e;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;e=this.$video.srcObject}else e=(await this._getCameraStream()).stream;return"torch"in e.getVideoTracks()[0].getSettings()}catch{return!1}finally{e&&e!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),R._stopVideoStream(e))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(e){throw this._flashOn=!1,e}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),R._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:e,facingMode:s}=await this._getCameraStream();!this._active||this._paused?R._stopVideoStream(e):(this._setVideoMirror(s),this.$video.srcObject=e,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(e){if(!this._paused)throw this._active=!1,e}}stop(){this.pause(),this._active=!1}async pause(e=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let s=()=>{this.$video.srcObject instanceof MediaStream&&(R._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return e?(s(),!0):(await new Promise(n=>setTimeout(n,300)),this._paused?(s(),!0):!1)}async setCamera(e){e!==this._preferredCamera&&(this._preferredCamera=e,await this._restartVideoStream())}static async scanImage(e,s,n,a,o=!1,c=!1){let l,f=!1;s&&("scanRegion"in s||"qrEngine"in s||"canvas"in s||"disallowCanvasResizing"in s||"alsoTryWithoutScanRegion"in s||"returnDetailedScanResult"in s)?(l=s.scanRegion,n=s.qrEngine,a=s.canvas,o=s.disallowCanvasResizing||!1,c=s.alsoTryWithoutScanRegion||!1,f=!0):console.warn(s||n||a||o||c?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),s=!!n;try{let m,h;[n,m]=await Promise.all([n||R.createQrEngine(),R._loadImage(e)]),[a,h]=R._drawToCanvas(m,l,a,o);let p;if(n instanceof Worker){let y=n;s||R._postWorkerMessageSync(y,"inversionMode","both"),p=await new Promise((_,x)=>{let w,b,T,L=-1;b=D=>{D.data.id===L&&(y.removeEventListener("message",b),y.removeEventListener("error",T),clearTimeout(w),D.data.data!==null?_({data:D.data.data,cornerPoints:R._convertPoints(D.data.cornerPoints,l)}):x(R.NO_QR_CODE_FOUND))},T=D=>{y.removeEventListener("message",b),y.removeEventListener("error",T),clearTimeout(w),x("Scanner error: "+(D?D.message||D:"Unknown Error"))},y.addEventListener("message",b),y.addEventListener("error",T),w=setTimeout(()=>T("timeout"),1e4);let E=h.getImageData(0,0,a.width,a.height);L=R._postWorkerMessageSync(y,"decode",E,[E.data.buffer])})}else p=await Promise.race([new Promise((y,_)=>window.setTimeout(()=>_("Scanner error: timeout"),1e4)),(async()=>{try{var[y]=await n.detect(a);if(!y)throw R.NO_QR_CODE_FOUND;return{data:y.rawValue,cornerPoints:R._convertPoints(y.cornerPoints,l)}}catch(_){if(y=_.message||_,/not implemented|service unavailable/.test(y))return R._disableBarcodeDetector=!0,R.scanImage(e,{scanRegion:l,canvas:a,disallowCanvasResizing:o,alsoTryWithoutScanRegion:c});throw`Scanner error: ${y}`}})()]);return f?p:p.data}catch(m){if(!l||!c)throw m;let h=await R.scanImage(e,{qrEngine:n,canvas:a,disallowCanvasResizing:o});return f?h:h.data}finally{s||R._postWorkerMessage(n,"close")}}setGrayscaleWeights(e,s,n,a=!0){R._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:s,blue:n,useIntegerApproximation:a})}setInversionMode(e){R._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}static async createQrEngine(e){if(e&&console.warn("Specifying a worker path is not required and not supported anymore."),e=()=>wr(()=>import("./qr-scanner-worker.min-D85Z9gVD.js"),[]).then(n=>n.createWorker()),!(!R._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return e();let s=navigator.userAgentData;return s&&s.brands.some(({brand:n})=>/Chromium/i.test(n))&&/mac ?OS/i.test(s.platform)&&await s.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:n,platformVersion:a})=>/arm/i.test(n||"arm")&&13<=parseInt(a||"13")).catch(()=>!0)?e():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(e){let s=Math.round(.6666666666666666*Math.min(e.videoWidth,e.videoHeight));return{x:Math.round((e.videoWidth-s)/2),y:Math.round((e.videoHeight-s)/2),width:s,height:s,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var e=this.$video,s=e.videoWidth,n=e.videoHeight,a=e.offsetWidth,o=e.offsetHeight,c=e.offsetLeft,l=e.offsetTop,f=window.getComputedStyle(e),m=f.objectFit,h=s/n,p=a/o;switch(m){case"none":var y=s,_=n;break;case"fill":y=a,_=o;break;default:(m==="cover"?h>p:h<p)?(_=o,y=_*h):(y=a,_=y/h),m==="scale-down"&&(y=Math.min(y,s),_=Math.min(_,n))}var[x,w]=f.objectPosition.split(" ").map((T,L)=>{const E=parseFloat(T);return T.endsWith("%")?(L?o-_:a-y)*E/100:E});f=this._scanRegion.width||s,p=this._scanRegion.height||n,m=this._scanRegion.x||0;var b=this._scanRegion.y||0;h=this.$overlay.style,h.width=`${f/s*y}px`,h.height=`${p/n*_}px`,h.top=`${l+w+b/n*_}px`,n=/scaleX\(-1\)/.test(e.style.transform),h.left=`${c+(n?a-x-y:x)+(n?s-m-f:m)/s*y}px`,h.transform=e.style.transform}})}static _convertPoints(e,s){if(!s)return e;let n=s.x||0,a=s.y||0,o=s.width&&s.downScaledWidth?s.width/s.downScaledWidth:1;s=s.height&&s.downScaledHeight?s.height/s.downScaledHeight:1;for(let c of e)c.x=c.x*o+n,c.y=c.y*s+a;return e}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var e=Date.now()-this._lastScanTimestamp,s=1e3/this._maxScansPerSecond;e<s&&await new Promise(a=>setTimeout(a,s-e)),this._lastScanTimestamp=Date.now();try{var n=await R.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(a){if(!this._active)return;this._onDecodeError(a)}!R._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=R.createQrEngine()),n?(this._onDecode?this._onDecode(n):this._legacyOnDecode&&this._legacyOnDecode(n.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",n.cornerPoints.map(({x:a,y:o})=>`${a},${o}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(e){e!==R.NO_QR_CODE_FOUND&&console.log(e)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let e=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",s=[{width:{min:1024}},{width:{min:768}},{}],n=s.map(a=>Object.assign({},a,{[e]:{exact:this._preferredCamera}}));for(let a of[...n,...s])try{let o=await navigator.mediaDevices.getUserMedia({video:a,audio:!1}),c=this._getFacingMode(o)||(a.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:o,facingMode:c}}catch{}throw"Camera not found."}async _restartVideoStream(){let e=this._paused;await this.pause(!0)&&!e&&this._active&&await this.start()}static _stopVideoStream(e){for(let s of e.getTracks())s.stop(),e.removeTrack(s)}_setVideoMirror(e){this.$video.style.transform="scaleX("+(e==="user"?-1:1)+")"}_getFacingMode(e){return(e=e.getVideoTracks()[0])?/rear|back|environment/i.test(e.label)?"environment":/front|user|face/i.test(e.label)?"user":null:null}static _drawToCanvas(e,s,n,a=!1){n=n||document.createElement("canvas");let o=s&&s.x?s.x:0,c=s&&s.y?s.y:0,l=s&&s.width?s.width:e.videoWidth||e.width,f=s&&s.height?s.height:e.videoHeight||e.height;return a||(a=s&&s.downScaledWidth?s.downScaledWidth:l,s=s&&s.downScaledHeight?s.downScaledHeight:f,n.width!==a&&(n.width=a),n.height!==s&&(n.height=s)),s=n.getContext("2d",{alpha:!1}),s.imageSmoothingEnabled=!1,s.drawImage(e,o,c,l,f,0,0,n.width,n.height),[n,s]}static async _loadImage(e){if(e instanceof Image)return await R._awaitImageLoad(e),e;if(e instanceof HTMLVideoElement||e instanceof HTMLCanvasElement||e instanceof SVGImageElement||"OffscreenCanvas"in window&&e instanceof OffscreenCanvas||"ImageBitmap"in window&&e instanceof ImageBitmap)return e;if(e instanceof File||e instanceof Blob||e instanceof URL||typeof e=="string"){let s=new Image;s.src=e instanceof File||e instanceof Blob?URL.createObjectURL(e):e.toString();try{return await R._awaitImageLoad(s),s}finally{(e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(s.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(e){e.complete&&e.naturalWidth!==0||await new Promise((s,n)=>{let a=o=>{e.removeEventListener("load",a),e.removeEventListener("error",a),o instanceof ErrorEvent?n("Image load error"):s()};e.addEventListener("load",a),e.addEventListener("error",a)})}static async _postWorkerMessage(e,s,n,a){return R._postWorkerMessageSync(await e,s,n,a)}static _postWorkerMessageSync(e,s,n,a){if(!(e instanceof Worker))return-1;let o=R._workerMessageId++;return e.postMessage({id:o,type:s,data:n},a),o}}R.DEFAULT_CANVAS_SIZE=400;R.NO_QR_CODE_FOUND="No QR code found";R._disableBarcodeDetector=!1;R._workerMessageId=0;let ut=null;const _r=()=>(!ut&&(window.AudioContext||window.webkitAudioContext)&&(ut=new(window.AudioContext||window.webkitAudioContext)),ut),G=(t="success")=>{if(!navigator.vibrate)return;const e={success:[200],warning:[100,50,100],error:[300,100,300,100,300],light:[50],scan:[100]};navigator.vibrate(e[t]||e.success)},Qt=(t="beep")=>{const e=_r();if(!e)return;const s=e.createOscillator(),n=e.createGain();s.connect(n),n.connect(e.destination);const a={beep:800,success:1e3,error:300,scan:600},o={beep:.1,success:.2,error:.3,scan:.05};s.frequency.setValueAtTime(a[t]||a.beep,e.currentTime),s.type="sine",n.gain.setValueAtTime(.1,e.currentTime),n.gain.exponentialRampToValueAtTime(.01,e.currentTime+(o[t]||o.beep)),s.start(e.currentTime),s.stop(e.currentTime+(o[t]||o.beep))},Kt=(t="green")=>{const e={green:"#10B981",red:"#EF4444",blue:"#3B82F6",white:"#FFFFFF",yellow:"#F59E0B"},s=document.createElement("div");s.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: ${e[t]||e.green};
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 0.1s ease-in-out;
  `,document.body.appendChild(s),requestAnimationFrame(()=>{s.style.opacity="0.3",setTimeout(()=>{s.style.opacity="0",setTimeout(()=>{document.body.removeChild(s)},100)},100)})},mt=()=>{G("success"),Qt("success"),Kt("green")},ye=()=>{G("error"),Qt("error"),Kt("red")};let W={scanStartTime:0,scanCount:0,averageScanTime:0,deviceInfo:null};const kt=()=>{if(W.deviceInfo)return W.deviceInfo;const t=navigator.userAgent,e=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t),s=/Android/i.test(t),n=/iPhone|iPad|iPod/i.test(t),a=/Chrome/i.test(t),o=/Safari/i.test(t)&&!/Chrome/i.test(t),c=/Firefox/i.test(t),l=navigator.deviceMemory||4,f=navigator.hardwareConcurrency||4;return W.deviceInfo={isMobile:e,isAndroid:s,isIOS:n,isChrome:a,isSafari:o,isFirefox:c,deviceMemory:l,hardwareConcurrency:f,userAgent:t},W.deviceInfo},kr=(t="environment")=>{const e=kt(),s={facingMode:t,width:{ideal:1280,min:640,max:1920},height:{ideal:720,min:480,max:1080},frameRate:{ideal:30,min:15,max:60}};return e.isAndroid?{...s,width:{ideal:1280,min:640,max:1920},height:{ideal:720,min:480,max:1080},frameRate:{ideal:30,min:15,max:60},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"},{whiteBalanceMode:"continuous"}]}:e.isIOS?{...s,width:{ideal:1920,min:1280,max:1920},height:{ideal:1080,min:720,max:1080},frameRate:{ideal:30,min:24,max:60},advanced:[{focusMode:"continuous"},{exposureMode:"continuous"}]}:{...s,width:{ideal:1920,min:1280,max:1920},height:{ideal:1080,min:720,max:1080},frameRate:{ideal:30,min:15,max:60}}},Sr=()=>{const t=kt(),e={returnDetailedScanResult:!0,highlightScanRegion:!1,highlightCodeOutline:!1,onDecodeError:s=>{console.debug("QR decode error:",s)}};return t.isMobile?{...e,maxScansPerSecond:t.deviceMemory>=6?30:20,preferredCamera:"environment"}:{...e,maxScansPerSecond:60,preferredCamera:"environment"}},Cr=()=>{W.scanStartTime=performance.now(),W.scanCount=0,W.averageScanTime=0},Rr=()=>{const t=performance.now()-W.scanStartTime;W.scanCount++,W.averageScanTime=(W.averageScanTime*(W.scanCount-1)+t)/W.scanCount,console.log(`Scan ${W.scanCount}: ${t.toFixed(2)}ms (avg: ${W.averageScanTime.toFixed(2)}ms)`)},Er=()=>{console.clear(),window.gc&&window.gc(),W.scanCount>100&&(W.scanCount=0,W.averageScanTime=0)};function Gt(t,e){return function(){return t.apply(e,arguments)}}const{toString:Tr}=Object.prototype,{getPrototypeOf:St}=Object,st=(t=>e=>{const s=Tr.call(e);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),ne=t=>(t=t.toLowerCase(),e=>st(e)===t),nt=t=>e=>typeof e===t,{isArray:Ce}=Array,He=nt("undefined");function Or(t){return t!==null&&!He(t)&&t.constructor!==null&&!He(t.constructor)&&ee(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Xt=ne("ArrayBuffer");function Lr(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Xt(t.buffer),e}const Ar=nt("string"),ee=nt("function"),Zt=nt("number"),at=t=>t!==null&&typeof t=="object",Mr=t=>t===!0||t===!1,Ze=t=>{if(st(t)!=="object")return!1;const e=St(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Dr=ne("Date"),Pr=ne("File"),$r=ne("Blob"),Br=ne("FileList"),Fr=t=>at(t)&&ee(t.pipe),Ir=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ee(t.append)&&((e=st(t))==="formdata"||e==="object"&&ee(t.toString)&&t.toString()==="[object FormData]"))},Hr=ne("URLSearchParams"),[zr,Ur,Wr,qr]=["ReadableStream","Request","Response","Headers"].map(ne),Vr=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ze(t,e,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),Ce(t))for(n=0,a=t.length;n<a;n++)e.call(null,t[n],n,t);else{const o=s?Object.getOwnPropertyNames(t):Object.keys(t),c=o.length;let l;for(n=0;n<c;n++)l=o[n],e.call(null,t[l],l,t)}}function Yt(t,e){e=e.toLowerCase();const s=Object.keys(t);let n=s.length,a;for(;n-- >0;)if(a=s[n],e===a.toLowerCase())return a;return null}const we=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,er=t=>!He(t)&&t!==we;function yt(){const{caseless:t}=er(this)&&this||{},e={},s=(n,a)=>{const o=t&&Yt(e,a)||a;Ze(e[o])&&Ze(n)?e[o]=yt(e[o],n):Ze(n)?e[o]=yt({},n):Ce(n)?e[o]=n.slice():e[o]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&ze(arguments[n],s);return e}const Jr=(t,e,s,{allOwnKeys:n}={})=>(ze(e,(a,o)=>{s&&ee(a)?t[o]=Gt(a,s):t[o]=a},{allOwnKeys:n}),t),Qr=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Kr=(t,e,s,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),s&&Object.assign(t.prototype,s)},Gr=(t,e,s,n)=>{let a,o,c;const l={};if(e=e||{},t==null)return e;do{for(a=Object.getOwnPropertyNames(t),o=a.length;o-- >0;)c=a[o],(!n||n(c,t,e))&&!l[c]&&(e[c]=t[c],l[c]=!0);t=s!==!1&&St(t)}while(t&&(!s||s(t,e))&&t!==Object.prototype);return e},Xr=(t,e,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=e.length;const n=t.indexOf(e,s);return n!==-1&&n===s},Zr=t=>{if(!t)return null;if(Ce(t))return t;let e=t.length;if(!Zt(e))return null;const s=new Array(e);for(;e-- >0;)s[e]=t[e];return s},Yr=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&St(Uint8Array)),es=(t,e)=>{const n=(t&&t[Symbol.iterator]).call(t);let a;for(;(a=n.next())&&!a.done;){const o=a.value;e.call(t,o[0],o[1])}},ts=(t,e)=>{let s;const n=[];for(;(s=t.exec(e))!==null;)n.push(s);return n},rs=ne("HTMLFormElement"),ss=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,a){return n.toUpperCase()+a}),At=(({hasOwnProperty:t})=>(e,s)=>t.call(e,s))(Object.prototype),ns=ne("RegExp"),tr=(t,e)=>{const s=Object.getOwnPropertyDescriptors(t),n={};ze(s,(a,o)=>{let c;(c=e(a,o,t))!==!1&&(n[o]=c||a)}),Object.defineProperties(t,n)},as=t=>{tr(t,(e,s)=>{if(ee(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=t[s];if(ee(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},is=(t,e)=>{const s={},n=a=>{a.forEach(o=>{s[o]=!0})};return Ce(t)?n(t):n(String(t).split(e)),s},os=()=>{},cs=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,ht="abcdefghijklmnopqrstuvwxyz",Mt="0123456789",rr={DIGIT:Mt,ALPHA:ht,ALPHA_DIGIT:ht+ht.toUpperCase()+Mt},ls=(t=16,e=rr.ALPHA_DIGIT)=>{let s="";const{length:n}=e;for(;t--;)s+=e[Math.random()*n|0];return s};function ds(t){return!!(t&&ee(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const us=t=>{const e=new Array(10),s=(n,a)=>{if(at(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[a]=n;const o=Ce(n)?[]:{};return ze(n,(c,l)=>{const f=s(c,a+1);!He(f)&&(o[l]=f)}),e[a]=void 0,o}}return n};return s(t,0)},ms=ne("AsyncFunction"),hs=t=>t&&(at(t)||ee(t))&&ee(t.then)&&ee(t.catch),sr=((t,e)=>t?setImmediate:e?((s,n)=>(we.addEventListener("message",({source:a,data:o})=>{a===we&&o===s&&n.length&&n.shift()()},!1),a=>{n.push(a),we.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ee(we.postMessage)),fs=typeof queueMicrotask<"u"?queueMicrotask.bind(we):typeof process<"u"&&process.nextTick||sr,d={isArray:Ce,isArrayBuffer:Xt,isBuffer:Or,isFormData:Ir,isArrayBufferView:Lr,isString:Ar,isNumber:Zt,isBoolean:Mr,isObject:at,isPlainObject:Ze,isReadableStream:zr,isRequest:Ur,isResponse:Wr,isHeaders:qr,isUndefined:He,isDate:Dr,isFile:Pr,isBlob:$r,isRegExp:ns,isFunction:ee,isStream:Fr,isURLSearchParams:Hr,isTypedArray:Yr,isFileList:Br,forEach:ze,merge:yt,extend:Jr,trim:Vr,stripBOM:Qr,inherits:Kr,toFlatObject:Gr,kindOf:st,kindOfTest:ne,endsWith:Xr,toArray:Zr,forEachEntry:es,matchAll:ts,isHTMLForm:rs,hasOwnProperty:At,hasOwnProp:At,reduceDescriptors:tr,freezeMethods:as,toObjectSet:is,toCamelCase:ss,noop:os,toFiniteNumber:cs,findKey:Yt,global:we,isContextDefined:er,ALPHABET:rr,generateString:ls,isSpecCompliantForm:ds,toJSONObject:us,isAsyncFn:ms,isThenable:hs,setImmediate:sr,asap:fs};function k(t,e,s,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),s&&(this.config=s),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}d.inherits(k,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:d.toJSONObject(this.config),code:this.code,status:this.status}}});const nr=k.prototype,ar={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ar[t]={value:t}});Object.defineProperties(k,ar);Object.defineProperty(nr,"isAxiosError",{value:!0});k.from=(t,e,s,n,a,o)=>{const c=Object.create(nr);return d.toFlatObject(t,c,function(f){return f!==Error.prototype},l=>l!=="isAxiosError"),k.call(c,t.message,e,s,n,a),c.cause=t,c.name=t.name,o&&Object.assign(c,o),c};const ps=null;function vt(t){return d.isPlainObject(t)||d.isArray(t)}function ir(t){return d.endsWith(t,"[]")?t.slice(0,-2):t}function Dt(t,e,s){return t?t.concat(e).map(function(a,o){return a=ir(a),!s&&o?"["+a+"]":a}).join(s?".":""):e}function gs(t){return d.isArray(t)&&!t.some(vt)}const xs=d.toFlatObject(d,{},null,function(e){return/^is[A-Z]/.test(e)});function it(t,e,s){if(!d.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,s=d.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,b){return!d.isUndefined(b[w])});const n=s.metaTokens,a=s.visitor||h,o=s.dots,c=s.indexes,f=(s.Blob||typeof Blob<"u"&&Blob)&&d.isSpecCompliantForm(e);if(!d.isFunction(a))throw new TypeError("visitor must be a function");function m(x){if(x===null)return"";if(d.isDate(x))return x.toISOString();if(!f&&d.isBlob(x))throw new k("Blob is not supported. Use a Buffer instead.");return d.isArrayBuffer(x)||d.isTypedArray(x)?f&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function h(x,w,b){let T=x;if(x&&!b&&typeof x=="object"){if(d.endsWith(w,"{}"))w=n?w:w.slice(0,-2),x=JSON.stringify(x);else if(d.isArray(x)&&gs(x)||(d.isFileList(x)||d.endsWith(w,"[]"))&&(T=d.toArray(x)))return w=ir(w),T.forEach(function(E,D){!(d.isUndefined(E)||E===null)&&e.append(c===!0?Dt([w],D,o):c===null?w:w+"[]",m(E))}),!1}return vt(x)?!0:(e.append(Dt(b,w,o),m(x)),!1)}const p=[],y=Object.assign(xs,{defaultVisitor:h,convertValue:m,isVisitable:vt});function _(x,w){if(!d.isUndefined(x)){if(p.indexOf(x)!==-1)throw Error("Circular reference detected in "+w.join("."));p.push(x),d.forEach(x,function(T,L){(!(d.isUndefined(T)||T===null)&&a.call(e,T,d.isString(L)?L.trim():L,w,y))===!0&&_(T,w?w.concat(L):[L])}),p.pop()}}if(!d.isObject(t))throw new TypeError("data must be an object");return _(t),e}function Pt(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Ct(t,e){this._pairs=[],t&&it(t,this,e)}const or=Ct.prototype;or.append=function(e,s){this._pairs.push([e,s])};or.toString=function(e){const s=e?function(n){return e.call(this,n,Pt)}:Pt;return this._pairs.map(function(a){return s(a[0])+"="+s(a[1])},"").join("&")};function bs(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function cr(t,e,s){if(!e)return t;const n=s&&s.encode||bs;d.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let o;if(a?o=a(e,s):o=d.isURLSearchParams(e)?e.toString():new Ct(e,s).toString(n),o){const c=t.indexOf("#");c!==-1&&(t=t.slice(0,c)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class $t{constructor(){this.handlers=[]}use(e,s,n){return this.handlers.push({fulfilled:e,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){d.forEach(this.handlers,function(n){n!==null&&e(n)})}}const lr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ys=typeof URLSearchParams<"u"?URLSearchParams:Ct,vs=typeof FormData<"u"?FormData:null,ws=typeof Blob<"u"?Blob:null,js={isBrowser:!0,classes:{URLSearchParams:ys,FormData:vs,Blob:ws},protocols:["http","https","file","blob","url","data"]},Rt=typeof window<"u"&&typeof document<"u",wt=typeof navigator=="object"&&navigator||void 0,Ns=Rt&&(!wt||["ReactNative","NativeScript","NS"].indexOf(wt.product)<0),_s=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ks=Rt&&window.location.href||"http://localhost",Ss=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Rt,hasStandardBrowserEnv:Ns,hasStandardBrowserWebWorkerEnv:_s,navigator:wt,origin:ks},Symbol.toStringTag,{value:"Module"})),J={...Ss,...js};function Cs(t,e){return it(t,new J.classes.URLSearchParams,Object.assign({visitor:function(s,n,a,o){return J.isNode&&d.isBuffer(s)?(this.append(n,s.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Rs(t){return d.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Es(t){const e={},s=Object.keys(t);let n;const a=s.length;let o;for(n=0;n<a;n++)o=s[n],e[o]=t[o];return e}function dr(t){function e(s,n,a,o){let c=s[o++];if(c==="__proto__")return!0;const l=Number.isFinite(+c),f=o>=s.length;return c=!c&&d.isArray(a)?a.length:c,f?(d.hasOwnProp(a,c)?a[c]=[a[c],n]:a[c]=n,!l):((!a[c]||!d.isObject(a[c]))&&(a[c]=[]),e(s,n,a[c],o)&&d.isArray(a[c])&&(a[c]=Es(a[c])),!l)}if(d.isFormData(t)&&d.isFunction(t.entries)){const s={};return d.forEachEntry(t,(n,a)=>{e(Rs(n),a,s,0)}),s}return null}function Ts(t,e,s){if(d.isString(t))try{return(e||JSON.parse)(t),d.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(t)}const Ue={transitional:lr,adapter:["xhr","http","fetch"],transformRequest:[function(e,s){const n=s.getContentType()||"",a=n.indexOf("application/json")>-1,o=d.isObject(e);if(o&&d.isHTMLForm(e)&&(e=new FormData(e)),d.isFormData(e))return a?JSON.stringify(dr(e)):e;if(d.isArrayBuffer(e)||d.isBuffer(e)||d.isStream(e)||d.isFile(e)||d.isBlob(e)||d.isReadableStream(e))return e;if(d.isArrayBufferView(e))return e.buffer;if(d.isURLSearchParams(e))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Cs(e,this.formSerializer).toString();if((l=d.isFileList(e))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return it(l?{"files[]":e}:e,f&&new f,this.formSerializer)}}return o||a?(s.setContentType("application/json",!1),Ts(e)):e}],transformResponse:[function(e){const s=this.transitional||Ue.transitional,n=s&&s.forcedJSONParsing,a=this.responseType==="json";if(d.isResponse(e)||d.isReadableStream(e))return e;if(e&&d.isString(e)&&(n&&!this.responseType||a)){const c=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(l){if(c)throw l.name==="SyntaxError"?k.from(l,k.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:J.classes.FormData,Blob:J.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};d.forEach(["delete","get","head","post","put","patch"],t=>{Ue.headers[t]={}});const Os=d.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ls=t=>{const e={};let s,n,a;return t&&t.split(`
`).forEach(function(c){a=c.indexOf(":"),s=c.substring(0,a).trim().toLowerCase(),n=c.substring(a+1).trim(),!(!s||e[s]&&Os[s])&&(s==="set-cookie"?e[s]?e[s].push(n):e[s]=[n]:e[s]=e[s]?e[s]+", "+n:n)}),e},Bt=Symbol("internals");function Ie(t){return t&&String(t).trim().toLowerCase()}function Ye(t){return t===!1||t==null?t:d.isArray(t)?t.map(Ye):String(t)}function As(t){const e=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(t);)e[n[1]]=n[2];return e}const Ms=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ft(t,e,s,n,a){if(d.isFunction(n))return n.call(this,e,s);if(a&&(e=s),!!d.isString(e)){if(d.isString(n))return e.indexOf(n)!==-1;if(d.isRegExp(n))return n.test(e)}}function Ds(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,s,n)=>s.toUpperCase()+n)}function Ps(t,e){const s=d.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+s,{value:function(a,o,c){return this[n].call(this,e,a,o,c)},configurable:!0})})}let X=class{constructor(e){e&&this.set(e)}set(e,s,n){const a=this;function o(l,f,m){const h=Ie(f);if(!h)throw new Error("header name must be a non-empty string");const p=d.findKey(a,h);(!p||a[p]===void 0||m===!0||m===void 0&&a[p]!==!1)&&(a[p||f]=Ye(l))}const c=(l,f)=>d.forEach(l,(m,h)=>o(m,h,f));if(d.isPlainObject(e)||e instanceof this.constructor)c(e,s);else if(d.isString(e)&&(e=e.trim())&&!Ms(e))c(Ls(e),s);else if(d.isHeaders(e))for(const[l,f]of e.entries())o(f,l,n);else e!=null&&o(s,e,n);return this}get(e,s){if(e=Ie(e),e){const n=d.findKey(this,e);if(n){const a=this[n];if(!s)return a;if(s===!0)return As(a);if(d.isFunction(s))return s.call(this,a,n);if(d.isRegExp(s))return s.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,s){if(e=Ie(e),e){const n=d.findKey(this,e);return!!(n&&this[n]!==void 0&&(!s||ft(this,this[n],n,s)))}return!1}delete(e,s){const n=this;let a=!1;function o(c){if(c=Ie(c),c){const l=d.findKey(n,c);l&&(!s||ft(n,n[l],l,s))&&(delete n[l],a=!0)}}return d.isArray(e)?e.forEach(o):o(e),a}clear(e){const s=Object.keys(this);let n=s.length,a=!1;for(;n--;){const o=s[n];(!e||ft(this,this[o],o,e,!0))&&(delete this[o],a=!0)}return a}normalize(e){const s=this,n={};return d.forEach(this,(a,o)=>{const c=d.findKey(n,o);if(c){s[c]=Ye(a),delete s[o];return}const l=e?Ds(o):String(o).trim();l!==o&&delete s[o],s[l]=Ye(a),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const s=Object.create(null);return d.forEach(this,(n,a)=>{n!=null&&n!==!1&&(s[a]=e&&d.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,s])=>e+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...s){const n=new this(e);return s.forEach(a=>n.set(a)),n}static accessor(e){const n=(this[Bt]=this[Bt]={accessors:{}}).accessors,a=this.prototype;function o(c){const l=Ie(c);n[l]||(Ps(a,c),n[l]=!0)}return d.isArray(e)?e.forEach(o):o(e),this}};X.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);d.reduceDescriptors(X.prototype,({value:t},e)=>{let s=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[s]=n}}});d.freezeMethods(X);function pt(t,e){const s=this||Ue,n=e||s,a=X.from(n.headers);let o=n.data;return d.forEach(t,function(l){o=l.call(s,o,a.normalize(),e?e.status:void 0)}),a.normalize(),o}function ur(t){return!!(t&&t.__CANCEL__)}function Re(t,e,s){k.call(this,t??"canceled",k.ERR_CANCELED,e,s),this.name="CanceledError"}d.inherits(Re,k,{__CANCEL__:!0});function mr(t,e,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?t(s):e(new k("Request failed with status code "+s.status,[k.ERR_BAD_REQUEST,k.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function $s(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Bs(t,e){t=t||10;const s=new Array(t),n=new Array(t);let a=0,o=0,c;return e=e!==void 0?e:1e3,function(f){const m=Date.now(),h=n[o];c||(c=m),s[a]=f,n[a]=m;let p=o,y=0;for(;p!==a;)y+=s[p++],p=p%t;if(a=(a+1)%t,a===o&&(o=(o+1)%t),m-c<e)return;const _=h&&m-h;return _?Math.round(y*1e3/_):void 0}}function Fs(t,e){let s=0,n=1e3/e,a,o;const c=(m,h=Date.now())=>{s=h,a=null,o&&(clearTimeout(o),o=null),t.apply(null,m)};return[(...m)=>{const h=Date.now(),p=h-s;p>=n?c(m,h):(a=m,o||(o=setTimeout(()=>{o=null,c(a)},n-p)))},()=>a&&c(a)]}const tt=(t,e,s=3)=>{let n=0;const a=Bs(50,250);return Fs(o=>{const c=o.loaded,l=o.lengthComputable?o.total:void 0,f=c-n,m=a(f),h=c<=l;n=c;const p={loaded:c,total:l,progress:l?c/l:void 0,bytes:f,rate:m||void 0,estimated:m&&l&&h?(l-c)/m:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(p)},s)},Ft=(t,e)=>{const s=t!=null;return[n=>e[0]({lengthComputable:s,total:t,loaded:n}),e[1]]},It=t=>(...e)=>d.asap(()=>t(...e)),Is=J.hasStandardBrowserEnv?((t,e)=>s=>(s=new URL(s,J.origin),t.protocol===s.protocol&&t.host===s.host&&(e||t.port===s.port)))(new URL(J.origin),J.navigator&&/(msie|trident)/i.test(J.navigator.userAgent)):()=>!0,Hs=J.hasStandardBrowserEnv?{write(t,e,s,n,a,o){const c=[t+"="+encodeURIComponent(e)];d.isNumber(s)&&c.push("expires="+new Date(s).toGMTString()),d.isString(n)&&c.push("path="+n),d.isString(a)&&c.push("domain="+a),o===!0&&c.push("secure"),document.cookie=c.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function zs(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Us(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function hr(t,e){return t&&!zs(e)?Us(t,e):e}const Ht=t=>t instanceof X?{...t}:t;function Ne(t,e){e=e||{};const s={};function n(m,h,p,y){return d.isPlainObject(m)&&d.isPlainObject(h)?d.merge.call({caseless:y},m,h):d.isPlainObject(h)?d.merge({},h):d.isArray(h)?h.slice():h}function a(m,h,p,y){if(d.isUndefined(h)){if(!d.isUndefined(m))return n(void 0,m,p,y)}else return n(m,h,p,y)}function o(m,h){if(!d.isUndefined(h))return n(void 0,h)}function c(m,h){if(d.isUndefined(h)){if(!d.isUndefined(m))return n(void 0,m)}else return n(void 0,h)}function l(m,h,p){if(p in e)return n(m,h);if(p in t)return n(void 0,m)}const f={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:l,headers:(m,h,p)=>a(Ht(m),Ht(h),p,!0)};return d.forEach(Object.keys(Object.assign({},t,e)),function(h){const p=f[h]||a,y=p(t[h],e[h],h);d.isUndefined(y)&&p!==l||(s[h]=y)}),s}const fr=t=>{const e=Ne({},t);let{data:s,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:o,headers:c,auth:l}=e;e.headers=c=X.from(c),e.url=cr(hr(e.baseURL,e.url),t.params,t.paramsSerializer),l&&c.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let f;if(d.isFormData(s)){if(J.hasStandardBrowserEnv||J.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((f=c.getContentType())!==!1){const[m,...h]=f?f.split(";").map(p=>p.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...h].join("; "))}}if(J.hasStandardBrowserEnv&&(n&&d.isFunction(n)&&(n=n(e)),n||n!==!1&&Is(e.url))){const m=a&&o&&Hs.read(o);m&&c.set(a,m)}return e},Ws=typeof XMLHttpRequest<"u",qs=Ws&&function(t){return new Promise(function(s,n){const a=fr(t);let o=a.data;const c=X.from(a.headers).normalize();let{responseType:l,onUploadProgress:f,onDownloadProgress:m}=a,h,p,y,_,x;function w(){_&&_(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function T(){if(!b)return;const E=X.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),I={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:E,config:t,request:b};mr(function(te){s(te),w()},function(te){n(te),w()},I),b=null}"onloadend"in b?b.onloadend=T:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(T)},b.onabort=function(){b&&(n(new k("Request aborted",k.ECONNABORTED,t,b)),b=null)},b.onerror=function(){n(new k("Network Error",k.ERR_NETWORK,t,b)),b=null},b.ontimeout=function(){let D=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const I=a.transitional||lr;a.timeoutErrorMessage&&(D=a.timeoutErrorMessage),n(new k(D,I.clarifyTimeoutError?k.ETIMEDOUT:k.ECONNABORTED,t,b)),b=null},o===void 0&&c.setContentType(null),"setRequestHeader"in b&&d.forEach(c.toJSON(),function(D,I){b.setRequestHeader(I,D)}),d.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),l&&l!=="json"&&(b.responseType=a.responseType),m&&([y,x]=tt(m,!0),b.addEventListener("progress",y)),f&&b.upload&&([p,_]=tt(f),b.upload.addEventListener("progress",p),b.upload.addEventListener("loadend",_)),(a.cancelToken||a.signal)&&(h=E=>{b&&(n(!E||E.type?new Re(null,t,b):E),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const L=$s(a.url);if(L&&J.protocols.indexOf(L)===-1){n(new k("Unsupported protocol "+L+":",k.ERR_BAD_REQUEST,t));return}b.send(o||null)})},Vs=(t,e)=>{const{length:s}=t=t?t.filter(Boolean):[];if(e||s){let n=new AbortController,a;const o=function(m){if(!a){a=!0,l();const h=m instanceof Error?m:this.reason;n.abort(h instanceof k?h:new Re(h instanceof Error?h.message:h))}};let c=e&&setTimeout(()=>{c=null,o(new k(`timeout ${e} of ms exceeded`,k.ETIMEDOUT))},e);const l=()=>{t&&(c&&clearTimeout(c),c=null,t.forEach(m=>{m.unsubscribe?m.unsubscribe(o):m.removeEventListener("abort",o)}),t=null)};t.forEach(m=>m.addEventListener("abort",o));const{signal:f}=n;return f.unsubscribe=()=>d.asap(l),f}},Js=function*(t,e){let s=t.byteLength;if(s<e){yield t;return}let n=0,a;for(;n<s;)a=n+e,yield t.slice(n,a),n=a},Qs=async function*(t,e){for await(const s of Ks(t))yield*Js(s,e)},Ks=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:s,value:n}=await e.read();if(s)break;yield n}}finally{await e.cancel()}},zt=(t,e,s,n)=>{const a=Qs(t,e);let o=0,c,l=f=>{c||(c=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:m,value:h}=await a.next();if(m){l(),f.close();return}let p=h.byteLength;if(s){let y=o+=p;s(y)}f.enqueue(new Uint8Array(h))}catch(m){throw l(m),m}},cancel(f){return l(f),a.return()}},{highWaterMark:2})},ot=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",pr=ot&&typeof ReadableStream=="function",Gs=ot&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),gr=(t,...e)=>{try{return!!t(...e)}catch{return!1}},Xs=pr&&gr(()=>{let t=!1;const e=new Request(J.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Ut=64*1024,jt=pr&&gr(()=>d.isReadableStream(new Response("").body)),rt={stream:jt&&(t=>t.body)};ot&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!rt[e]&&(rt[e]=d.isFunction(t[e])?s=>s[e]():(s,n)=>{throw new k(`Response type '${e}' is not supported`,k.ERR_NOT_SUPPORT,n)})})})(new Response);const Zs=async t=>{if(t==null)return 0;if(d.isBlob(t))return t.size;if(d.isSpecCompliantForm(t))return(await new Request(J.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(d.isArrayBufferView(t)||d.isArrayBuffer(t))return t.byteLength;if(d.isURLSearchParams(t)&&(t=t+""),d.isString(t))return(await Gs(t)).byteLength},Ys=async(t,e)=>{const s=d.toFiniteNumber(t.getContentLength());return s??Zs(e)},en=ot&&(async t=>{let{url:e,method:s,data:n,signal:a,cancelToken:o,timeout:c,onDownloadProgress:l,onUploadProgress:f,responseType:m,headers:h,withCredentials:p="same-origin",fetchOptions:y}=fr(t);m=m?(m+"").toLowerCase():"text";let _=Vs([a,o&&o.toAbortSignal()],c),x;const w=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let b;try{if(f&&Xs&&s!=="get"&&s!=="head"&&(b=await Ys(h,n))!==0){let I=new Request(e,{method:"POST",body:n,duplex:"half"}),q;if(d.isFormData(n)&&(q=I.headers.get("content-type"))&&h.setContentType(q),I.body){const[te,ae]=Ft(b,tt(It(f)));n=zt(I.body,Ut,te,ae)}}d.isString(p)||(p=p?"include":"omit");const T="credentials"in Request.prototype;x=new Request(e,{...y,signal:_,method:s.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:T?p:void 0});let L=await fetch(x);const E=jt&&(m==="stream"||m==="response");if(jt&&(l||E&&w)){const I={};["status","statusText","headers"].forEach(he=>{I[he]=L[he]});const q=d.toFiniteNumber(L.headers.get("content-length")),[te,ae]=l&&Ft(q,tt(It(l),!0))||[];L=new Response(zt(L.body,Ut,te,()=>{ae&&ae(),w&&w()}),I)}m=m||"text";let D=await rt[d.findKey(rt,m)||"text"](L,t);return!E&&w&&w(),await new Promise((I,q)=>{mr(I,q,{data:D,headers:X.from(L.headers),status:L.status,statusText:L.statusText,config:t,request:x})})}catch(T){throw w&&w(),T&&T.name==="TypeError"&&/fetch/i.test(T.message)?Object.assign(new k("Network Error",k.ERR_NETWORK,t,x),{cause:T.cause||T}):k.from(T,T&&T.code,t,x)}}),Nt={http:ps,xhr:qs,fetch:en};d.forEach(Nt,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Wt=t=>`- ${t}`,tn=t=>d.isFunction(t)||t===null||t===!1,xr={getAdapter:t=>{t=d.isArray(t)?t:[t];const{length:e}=t;let s,n;const a={};for(let o=0;o<e;o++){s=t[o];let c;if(n=s,!tn(s)&&(n=Nt[(c=String(s)).toLowerCase()],n===void 0))throw new k(`Unknown adapter '${c}'`);if(n)break;a[c||"#"+o]=n}if(!n){const o=Object.entries(a).map(([l,f])=>`adapter ${l} `+(f===!1?"is not supported by the environment":"is not available in the build"));let c=e?o.length>1?`since :
`+o.map(Wt).join(`
`):" "+Wt(o[0]):"as no adapter specified";throw new k("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return n},adapters:Nt};function gt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Re(null,t)}function qt(t){return gt(t),t.headers=X.from(t.headers),t.data=pt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),xr.getAdapter(t.adapter||Ue.adapter)(t).then(function(n){return gt(t),n.data=pt.call(t,t.transformResponse,n),n.headers=X.from(n.headers),n},function(n){return ur(n)||(gt(t),n&&n.response&&(n.response.data=pt.call(t,t.transformResponse,n.response),n.response.headers=X.from(n.response.headers))),Promise.reject(n)})}const br="1.7.9",ct={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{ct[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Vt={};ct.transitional=function(e,s,n){function a(o,c){return"[Axios v"+br+"] Transitional option '"+o+"'"+c+(n?". "+n:"")}return(o,c,l)=>{if(e===!1)throw new k(a(c," has been removed"+(s?" in "+s:"")),k.ERR_DEPRECATED);return s&&!Vt[c]&&(Vt[c]=!0,console.warn(a(c," has been deprecated since v"+s+" and will be removed in the near future"))),e?e(o,c,l):!0}};ct.spelling=function(e){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function rn(t,e,s){if(typeof t!="object")throw new k("options must be an object",k.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const o=n[a],c=e[o];if(c){const l=t[o],f=l===void 0||c(l,o,t);if(f!==!0)throw new k("option "+o+" must be "+f,k.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new k("Unknown option "+o,k.ERR_BAD_OPTION)}}const et={assertOptions:rn,validators:ct},ie=et.validators;let je=class{constructor(e){this.defaults=e,this.interceptors={request:new $t,response:new $t}}async request(e,s){try{return await this._request(e,s)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,s){typeof e=="string"?(s=s||{},s.url=e):s=e||{},s=Ne(this.defaults,s);const{transitional:n,paramsSerializer:a,headers:o}=s;n!==void 0&&et.assertOptions(n,{silentJSONParsing:ie.transitional(ie.boolean),forcedJSONParsing:ie.transitional(ie.boolean),clarifyTimeoutError:ie.transitional(ie.boolean)},!1),a!=null&&(d.isFunction(a)?s.paramsSerializer={serialize:a}:et.assertOptions(a,{encode:ie.function,serialize:ie.function},!0)),et.assertOptions(s,{baseUrl:ie.spelling("baseURL"),withXsrfToken:ie.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let c=o&&d.merge(o.common,o[s.method]);o&&d.forEach(["delete","get","head","post","put","patch","common"],x=>{delete o[x]}),s.headers=X.concat(c,o);const l=[];let f=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(s)===!1||(f=f&&w.synchronous,l.unshift(w.fulfilled,w.rejected))});const m=[];this.interceptors.response.forEach(function(w){m.push(w.fulfilled,w.rejected)});let h,p=0,y;if(!f){const x=[qt.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,m),y=x.length,h=Promise.resolve(s);p<y;)h=h.then(x[p++],x[p++]);return h}y=l.length;let _=s;for(p=0;p<y;){const x=l[p++],w=l[p++];try{_=x(_)}catch(b){w.call(this,b);break}}try{h=qt.call(this,_)}catch(x){return Promise.reject(x)}for(p=0,y=m.length;p<y;)h=h.then(m[p++],m[p++]);return h}getUri(e){e=Ne(this.defaults,e);const s=hr(e.baseURL,e.url);return cr(s,e.params,e.paramsSerializer)}};d.forEach(["delete","get","head","options"],function(e){je.prototype[e]=function(s,n){return this.request(Ne(n||{},{method:e,url:s,data:(n||{}).data}))}});d.forEach(["post","put","patch"],function(e){function s(n){return function(o,c,l){return this.request(Ne(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:c}))}}je.prototype[e]=s(),je.prototype[e+"Form"]=s(!0)});let sn=class yr{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(o){s=o});const n=this;this.promise.then(a=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](a);n._listeners=null}),this.promise.then=a=>{let o;const c=new Promise(l=>{n.subscribe(l),o=l}).then(a);return c.cancel=function(){n.unsubscribe(o)},c},e(function(o,c,l){n.reason||(n.reason=new Re(o,c,l),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const s=this._listeners.indexOf(e);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const e=new AbortController,s=n=>{e.abort(n)};return this.subscribe(s),e.signal.unsubscribe=()=>this.unsubscribe(s),e.signal}static source(){let e;return{token:new yr(function(a){e=a}),cancel:e}}};function nn(t){return function(s){return t.apply(null,s)}}function an(t){return d.isObject(t)&&t.isAxiosError===!0}const _t={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_t).forEach(([t,e])=>{_t[e]=t});function vr(t){const e=new je(t),s=Gt(je.prototype.request,e);return d.extend(s,je.prototype,e,{allOwnKeys:!0}),d.extend(s,e,null,{allOwnKeys:!0}),s.create=function(a){return vr(Ne(t,a))},s}const H=vr(Ue);H.Axios=je;H.CanceledError=Re;H.CancelToken=sn;H.isCancel=ur;H.VERSION=br;H.toFormData=it;H.AxiosError=k;H.Cancel=H.CanceledError;H.all=function(e){return Promise.all(e)};H.spread=nn;H.isAxiosError=an;H.mergeConfig=Ne;H.AxiosHeaders=X;H.formToJSON=t=>dr(d.isHTMLForm(t)?new FormData(t):t);H.getAdapter=xr.getAdapter;H.HttpStatusCode=_t;H.default=H;const{Axios:fn,AxiosError:pn,CanceledError:gn,isCancel:xn,CancelToken:bn,VERSION:yn,all:vn,Cancel:wn,isAxiosError:jn,spread:Nn,toFormData:_n,AxiosHeaders:kn,HttpStatusCode:Sn,formToJSON:Cn,getAdapter:Rn,mergeConfig:En}=H,on="http://127.0.0.1:5000",Et=H.create({baseURL:on,withCredentials:!0,headers:{"Content-Type":"application/json"},credentials:"include"});Et.interceptors.request.use(t=>(t.withCredentials=!0,t),t=>Promise.reject(t));Et.interceptors.response.use(t=>t,t=>(console.error("API Error:",t.response||t),Promise.reject(t)));const cn="http://127.0.0.1:5000/api",ve=Et.create({baseURL:cn,headers:{Accept:"application/json","Content-Type":"application/json"},timeout:1e4}),se={async scanOrder(t,e="فني الصيانة"){var s,n;try{const a=await ve.post("/orders/scan",{tracking_number:t,user_name:e,force_create:!1});return{success:!0,data:a.data.data,message:a.data.message}}catch(a){console.error("Error scanning order:",a);let o="فشل في جلب البيانات من الخادم";if(a.response){const c=a.response.status,l=(s=a.response.data)==null?void 0:s.message;switch(c){case 400:o=l||"بيانات الطلب غير صحيحة";break;case 404:o=l||"لم يتم العثور على الطلب في بوسطة";break;case 401:o="خطأ في المصادقة - تحقق من إعدادات API";break;case 500:o=l||"خطأ في الخادم - يرجى المحاولة مرة أخرى";break;default:o=l||`خطأ في الخادم: ${c}`}}else a.code==="NETWORK_ERROR"||a.code==="ERR_NETWORK"?o="خطأ في الاتصال بالشبكة - تحقق من اتصالك بالإنترنت":a.code==="ECONNABORTED"&&(o="انتهت مهلة الاتصال - يرجى المحاولة مرة أخرى");return{success:!1,data:null,message:o,error:((n=a.response)==null?void 0:n.status)||"NETWORK_ERROR"}}},async getOrdersByStatus(t,e=1,s=20){var n,a;try{const o=new URLSearchParams;return t&&o.append("status",t),o.append("page",e.toString()),o.append("limit",s.toString()),{success:!0,data:(await ve.get(`/orders?${o}`)).data.data,message:"تم جلب البيانات بنجاح"}}catch(o){return console.error("Error fetching orders:",o),{success:!1,data:{orders:[],pagination:{}},message:((a=(n=o.response)==null?void 0:n.data)==null?void 0:a.message)||"فشل في جلب البيانات"}}},async performOrderAction(t,e,s="",n="فني الصيانة",a={}){var o,c;try{const l=await ve.post(`/orders/${t}/action`,{action:e,notes:s,user_name:n,action_data:a});return{success:!0,data:l.data.data,message:l.data.message}}catch(l){return console.error("Error performing action:",l),{success:!1,data:null,message:((c=(o=l.response)==null?void 0:o.data)==null?void 0:c.message)||"فشل في تحديث الطلب"}}},async getOrdersSummary(){try{return{success:!0,data:(await ve.get("/orders/summary")).data.data,message:"تم جلب الملخص بنجاح"}}catch(t){return console.error("Error fetching summary:",t),{success:!1,data:{received:0,in_maintenance:0,completed:0,failed:0,sending:0,returned:0,total:0},message:"فشل في جلب الملخص"}}},async getRecentScans(t=10){try{return{success:!0,data:(await ve.get(`/orders/recent-scans?limit=${t}`)).data.data,message:"تم جلب البيانات بنجاح"}}catch(e){return console.error("Error fetching recent scans:",e),{success:!1,data:[],message:"فشل في جلب البيانات"}}},async searchOrders(t,e=null){try{const s=new URLSearchParams;return s.append("search",t),e&&s.append("status",e),{success:!0,data:(await ve.get(`/orders?${s}`)).data.data,message:"تم البحث بنجاح"}}catch(s){return console.error("Error searching orders:",s),{success:!1,data:{orders:[]},message:"فشل في البحث"}}},async getOrderByTracking(t){var e;try{return{success:!0,data:(await ve.get(`/orders/tracking/${t}`)).data.data,message:"تم العثور على الطلب"}}catch(s){return((e=s.response)==null?void 0:e.status)===404?{success:!1,data:null,message:"لم يتم العثور على الطلب"}:{success:!1,data:null,message:"خطأ في البحث عن الطلب"}}},transformBackendOrder(t){return t?{_id:t.id,trackingNumber:t.tracking_number,pickupAddress:{city:{nameAr:t.city||""},zone:{nameAr:t.zone||""},firstLine:t.pickup_address||""},dropOffAddress:{city:{nameAr:t.city||""},zone:{nameAr:t.zone||""},firstLine:t.dropoff_address||"",buildingNumber:t.building_number||"",floor:t.floor||"",apartment:t.apartment||""},cod:t.cod_amount||0,state:{value:this.mapBackendStatusToBostaState(t.status),code:this.getStatusCode(t.status),deliveryTime:t.updated_at},receiver:{fullName:t.customer_name||"",phone:t.customer_phone||"",secondPhone:t.customer_second_phone||""},type:{code:10,value:t.order_type||"Send"},timeline:t.timeline_data||[],specs:{packageDetails:{itemsCount:t.items_count||1,description:t.package_description||""},weight:t.package_weight||0},createdAt:t.created_at,scannedAt:t.scanned_at,status:t.status,isReturnOrder:t.is_return_order,isRefundOrReplace:t.is_refund_or_replace,maintenanceHistory:t.maintenance_history||[],newTrackingNumber:t.new_tracking_number,newCodAmount:t.new_cod_amount,bostaData:t.bosta_data||{}}:null},mapBackendStatusToBostaState(t){return{received:"Picked Up",in_maintenance:"In Transit",completed:"Ready for Delivery",failed:"Failed",sending:"Out for Delivery",returned:"Returned"}[t]||t},getStatusCode(t){return{received:23,in_maintenance:30,completed:40,failed:60,sending:43,returned:50}[t]||10}},Tn=()=>{var Ae,Me,De,Pe,$e,Be;const[t,e]=N.useState({isScanning:!1,isProcessing:!1,isInitializing:!1,hasPermission:!1,showCamera:!1,error:null,deviceInfo:null}),[s,n]=N.useState(null),[a,o]=N.useState(""),[c,l]=N.useState(!1),[f,m]=N.useState([]),[h,p]=N.useState(""),[y,_]=N.useState(0),[x,w]=N.useState(!1),[b,T]=N.useState(null),[L,E]=N.useState(null),[D,I]=N.useState(""),[q,te]=N.useState(0),[ae,he]=N.useState(!1),[U,fe]=N.useState("received"),[_e,pe]=N.useState({received:[],inMaintenance:[],completed:[],failed:[],returns:[],sending:[]}),[Q,oe]=N.useState({received:0,in_maintenance:0,completed:0,failed:0,sending:0,returned:0,total:0}),[Tt,Ot]=N.useState(null),[ge,Ee]=N.useState(null),[Te,A]=N.useState(!1),Oe=N.useRef(null),S=N.useRef(null),We=N.useRef(null),Z=N.useCallback(async u=>{if(u){A(!0);try{const v=await se.getOrdersByStatus(u);if(v.success){const C=v.data.orders.map(z=>se.transformBackendOrder(z)),B={in_maintenance:"inMaintenance",returned:"returns"}[u]||u;pe(z=>({...z,[B]:C}))}else console.warn(`Failed to load ${u} orders:`,v.message)}catch(v){console.error(`Error loading ${u} orders:`,v)}finally{A(!1)}}},[]),re=N.useCallback(async()=>{try{const u=await se.getOrdersSummary();u.success&&oe(u.data)}catch(u){console.error("Error loading orders summary:",u)}},[]),lt=N.useCallback(async()=>{await Z(U==="inMaintenance"?"in_maintenance":U),await re()},[U,Z,re]),xe=N.useCallback(async()=>{if(Oe.current){e(u=>({...u,isInitializing:!0,error:null}));try{Cr();const u=kt(),v=Sr(),C=kr("environment");if(console.log("Initializing QR Scanner with device info:",u),!window.isSecureContext&&window.location.protocol!=="http:"){console.warn("Camera requires secure context (HTTPS) for production"),e(j=>({...j,error:"الكاميرا تتطلب اتصال آمن (HTTPS) في الإنتاج",isInitializing:!1}));return}try{await navigator.mediaDevices.getUserMedia({video:!0}),e(j=>({...j,hasPermission:!0}))}catch{throw new Error("تم رفض إذن الكاميرا. يرجى السماح بالوصول للكاميرا في إعدادات المتصفح.")}S.current=new R(Oe.current,j=>{t.isProcessing||(Rr(),ue(j.data,j))},{...v,preferredCamera:"environment",constraints:{video:C},onDecodeError:j=>{console.debug("QR decode error:",j)},highlightScanRegion:!0,highlightCodeOutline:!0,maxScansPerSecond:10,validateScan:j=>{if(!j||!j.data)return!1;const B=j.data.trim();return B.length>=3&&B.length<=50}}),await S.current.start(),e(j=>({...j,isScanning:!0,isInitializing:!1,deviceInfo:u,error:null})),console.log("QR Scanner initialized successfully")}catch(u){console.error("QR Scanner initialization error:",u);let v="فشل في بدء مسح رمز QR.";u.name==="NotAllowedError"||u.message.includes("إذن الكاميرا")?v="تم رفض إذن الكاميرا. يرجى السماح بالوصول للكاميرا في إعدادات المتصفح.":u.name==="NotFoundError"?v="لم يتم العثور على كاميرا. تأكد من وجود كاميرا متصلة.":u.name==="NotSupportedError"?v="هذا المتصفح لا يدعم مسح رمز QR. جرب متصفح آخر.":u.name==="NotReadableError"&&(v="الكاميرا مشغولة من قبل تطبيق آخر. أغلق التطبيقات الأخرى التي تستخدم الكاميرا."),e(C=>({...C,error:v,isInitializing:!1,isScanning:!1})),ye()}}},[t.isProcessing]),ue=N.useCallback(async u=>{if(t.isProcessing)return;const v=Date.now(),C=v-q;if(D===u&&C<3e3){console.log("Debounced duplicate scan:",u);return}if(I(u),te(v),!u||typeof u!="string"){console.warn("Invalid QR data detected:",u),e(F=>({...F,error:"بيانات QR غير صحيحة"})),ye(),G("error"),setTimeout(()=>{e(F=>({...F,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},3e3);return}const B=u.trim();if(B.length<3){console.warn("Tracking number too short:",B),e(F=>({...F,error:"رقم التتبع قصير جداً"})),ye(),G("error"),setTimeout(()=>{e(F=>({...F,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},3e3);return}if([/^[0-9]{1,2}$/,/^[a-zA-Z]{1,2}$/,/^[\\\/\-_]{1,}$/,/^[0-9]{1,2}[a-zA-Z]{1,2}$/].some(F=>F.test(B))){console.warn("Invalid tracking number pattern:",B),e(F=>({...F,error:"نمط رقم التتبع غير صحيح"})),ye(),G("error"),setTimeout(()=>{e(F=>({...F,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},3e3);return}e(F=>({...F,isProcessing:!0,error:null}));try{console.log("Scanning order with tracking number:",B);const F=await se.getOrderByTracking(B);if(F.success){const V=se.transformBackendOrder(F.data),de=V.status==="in_maintenance"?"inMaintenance":V.status;fe(de),await Z(V.status),E(V._id),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100),setTimeout(()=>{E(null)},6e3),e(Y=>({...Y,error:`تم العثور على الطلب ${B} في ${g(de)}`})),mt(),G("success"),setTimeout(()=>{e(Y=>({...Y,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},4e3);return}if(f.find(V=>V.trackingNumber===B&&new Date().getTime()-new Date(V.scannedAt).getTime()<5e3)){console.log("Expert Mode: Auto-confirming duplicate scan for",B);const V=await se.scanOrder(B);if(V.success){const de=se.transformBackendOrder(V.data.order);fe("received"),await Z("received"),await re(),m(Y=>[de,...Y.slice(0,8)]),E(de._id),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{E(null)},4e3)},100),e(Y=>({...Y,error:`تم تأكيد استلام الطلب ${B} تلقائياً (وضع الخبير)`})),mt(),G("success"),setTimeout(()=>{e(Y=>({...Y,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},3e3);return}}const dt=await se.scanOrder(B);if(dt.success){const V=se.transformBackendOrder(dt.data.order);V.scannedAt=new Date().toISOString(),n(V),l(!0),m(de=>{const Y=de.findIndex(Fe=>Fe.trackingNumber===V.trackingNumber);if(Y!==-1){const Fe=[...de];return Fe[Y]={...Fe[Y],scannedAt:V.scannedAt},Fe}else return[V,...de.slice(0,8)]}),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100),mt(),G("success"),S.current&&typeof S.current.pause=="function"&&S.current.pause()}else throw new Error(dt.message)}catch(F){console.error("Error processing scanned data:",F),e(Xe=>({...Xe,error:F.message||"فشل في معالجة البيانات الممسوحة"})),ye(),G("error"),setTimeout(()=>{e(Xe=>({...Xe,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},3e3)}finally{setTimeout(()=>{e(F=>({...F,isProcessing:!1}))},1e3)}},[t.isProcessing,f,Z,re]),qe=async u=>{if(u.preventDefault(),a.trim()){he(!0);try{const v=a.trim();if(v.length<3){e(j=>({...j,error:"رقم التتبع قصير جداً"})),ye(),G("error"),setTimeout(()=>{e(j=>({...j,error:null}))},3e3);return}if([/^[0-9]{1,2}$/,/^[a-zA-Z]{1,2}$/,/^[\\\/\-_]{1,}$/,/^[0-9]{1,2}[a-zA-Z]{1,2}$/].some(j=>j.test(v))){e(j=>({...j,error:"نمط رقم التتبع غير صحيح"})),ye(),G("error"),setTimeout(()=>{e(j=>({...j,error:null}))},3e3);return}await ue(v),o("")}finally{he(!1)}}},Le=N.useCallback(u=>{u.key==="Enter"&&c&&s&&me()},[c,s]),be=N.useCallback(async u=>{const v=Date.now();v-y>100&&p(""),_(v),u.key.length===1&&p(C=>C+u.key),u.key==="Enter"&&h.trim()&&(u.preventDefault(),await ue(h.trim()),p(""))},[h,y,ue]);N.useEffect(()=>(document.addEventListener("keypress",Le),document.addEventListener("keypress",be),()=>{document.removeEventListener("keypress",Le),document.removeEventListener("keypress",be)}),[Le,be]),N.useEffect(()=>{(async()=>{await re(),await Z("received");try{const v=await se.getRecentScans(10);v.success?(console.log("Recent scans raw data:",v.data),console.log("First scan example:",v.data[0]),m(v.data)):console.warn("Failed to load recent scans:",v.message)}catch(v){console.error("Error loading recent scans:",v)}})()},[re,Z]),N.useEffect(()=>{const v={inMaintenance:"in_maintenance",returns:"returned"}[U]||U;Z(v)},[U,Z]),N.useEffect(()=>{t.showCamera&&(async()=>{try{await xe()}catch{console.log("Camera auto-start failed, will retry on user interaction")}})()},[xe,t.showCamera]);const ke=N.useCallback(()=>{try{S.current&&(S.current.stop(),S.current.destroy(),S.current=null),e(u=>({...u,isScanning:!1,isProcessing:!1,isInitializing:!1,error:null})),Er(),console.log("Camera stopped and resources cleaned up")}catch(u){console.error("Error stopping camera:",u)}},[]);N.useEffect(()=>()=>{console.log("OrderManagementPage unmounting, cleaning up resources..."),ke()},[ke]);const me=async()=>{if(s)try{n(null),l(!1),fe("received"),await Z("received"),await re(),S.current&&typeof S.current.resume=="function"&&S.current.resume(),G("success")}catch(u){console.error("Error confirming order:",u)}},ce=async(u,v,C="")=>{Ee(u);try{let j={};typeof C=="object"&&C!==null&&(j=C,C=j.notes||""),console.log(`Performing action: ${u} on order ${v._id}`);const B=await se.performOrderAction(v._id,u,C,"فني الصيانة",j);if(B.success){await lt();const z=Ve(u);z&&z!==U&&await Z(z==="inMaintenance"?"in_maintenance":z),G("success")}else throw new Error(B.message)}catch(j){console.error("Error performing action:",j),G("error")}finally{Ee(null)}},Ve=u=>({start_maintenance:"inMaintenance",complete_maintenance:"completed",fail_maintenance:"failed",reschedule:"inMaintenance",send_order:"sending",confirm_send:"sending",return_order:"returns",move_to_returns:"returns",refund_or_replace:"completed"})[u],i=u=>u.isReturnOrder||!1,g=u=>({received:"المستلمة",inMaintenance:"تحت الصيانة",completed:"مكتملة",failed:"فاشلة/معلقة",sending:"جاري الإرسال",returns:"المرتجعة"})[u]||u,O=u=>{const C={received:"blue",inMaintenance:"amber",completed:"green",failed:"red",sending:"purple",returns:"gray"}[u]||"blue";return{blue:"border-l-4 border-blue-500 bg-gradient-to-r from-blue-50/80 to-blue-100/40 shadow-lg shadow-blue-200/50 ring-2 ring-blue-300/30",amber:"border-l-4 border-amber-500 bg-gradient-to-r from-amber-50/80 to-amber-100/40 shadow-lg shadow-amber-200/50 ring-2 ring-amber-300/30",green:"border-l-4 border-green-500 bg-gradient-to-r from-green-50/80 to-green-100/40 shadow-lg shadow-green-200/50 ring-2 ring-green-300/30",red:"border-l-4 border-red-500 bg-gradient-to-r from-red-50/80 to-red-100/40 shadow-lg shadow-red-200/50 ring-2 ring-red-300/30",purple:"border-l-4 border-purple-500 bg-gradient-to-r from-purple-50/80 to-purple-100/40 shadow-lg shadow-purple-200/50 ring-2 ring-purple-300/30",gray:"border-l-4 border-gray-500 bg-gradient-to-r from-gray-50/80 to-gray-100/40 shadow-lg shadow-gray-200/50 ring-2 ring-gray-300/30"}[C]},$=N.useCallback(async()=>{e(u=>({...u,error:null})),await xe()},[xe]),P=N.useCallback(()=>{t.showCamera&&ke(),e(u=>({...u,showCamera:!u.showCamera}))},[t.showCamera,ke]),M=[{id:"received",label:"المستلمة",badge:Q.received.toString(),color:"blue"},{id:"inMaintenance",label:"تحت الصيانة",badge:Q.in_maintenance.toString(),color:"amber"},{id:"completed",label:"مكتملة",badge:Q.completed.toString(),color:"green"},{id:"failed",label:"فاشلة/معلقة",badge:Q.failed.toString(),color:"red"},{id:"sending",label:"جاري الإرسال",badge:Q.sending.toString(),color:"purple"},{id:"returns",label:"المرتجعة",badge:Q.returned.toString(),color:"gray"}],K=(u,v)=>{const C={blue:{active:"bg-blue-50 text-blue-700 border-2 border-blue-200",inactive:"text-blue-700 hover:bg-blue-50 hover:border-blue-200 border-2 border-transparent",badge:"bg-blue-100 text-blue-800",badgeActive:"bg-blue-200 text-blue-800"},amber:{active:"bg-amber-50 text-amber-700 border-2 border-amber-200",inactive:"text-amber-700 hover:bg-amber-50 hover:border-amber-200 border-2 border-transparent",badge:"bg-amber-100 text-amber-800",badgeActive:"bg-amber-200 text-amber-800"},green:{active:"bg-green-50 text-green-700 border-2 border-green-200",inactive:"text-green-700 hover:bg-green-50 hover:border-green-200 border-2 border-transparent",badge:"bg-green-100 text-green-800",badgeActive:"bg-green-200 text-green-800"},red:{active:"bg-red-50 text-red-700 border-2 border-red-200",inactive:"text-red-700 hover:bg-red-50 hover:border-red-200 border-2 border-transparent",badge:"bg-red-100 text-red-800",badgeActive:"bg-red-200 text-red-800"},purple:{active:"bg-purple-50 text-purple-700 border-2 border-purple-200",inactive:"text-purple-700 hover:bg-purple-50 hover:border-purple-200 border-2 border-transparent",badge:"bg-purple-100 text-purple-800",badgeActive:"bg-purple-200 text-purple-800"},gray:{active:"bg-gray-50 text-gray-700 border-2 border-gray-200",inactive:"text-gray-700 hover:bg-gray-50 hover:border-gray-200 border-2 border-transparent",badge:"bg-gray-100 text-gray-800",badgeActive:"bg-gray-200 text-gray-800"}};return C[u]||C.blue},le=({isOpen:u,onClose:v,order:C})=>{var B;if(!u||!C)return null;const j=[...(C.timeline||[]).map((z,F)=>({title:Se(z.value),description:Je(z.value),time:xt(z.date,!0),status:z.done?"completed":"pending",details:`المرحلة ${F+1} من ${C.timeline.length}`})),...(C.maintenanceHistory||[]).map((z,F)=>({title:Qe(z.action),description:z.notes,time:xt(z.timestamp,!0),status:Ke(z.action),details:`بواسطة: ${z.user}`}))];return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[r.jsx("div",{className:"bg-gradient-to-r from-brand-red-500 to-brand-red-600 px-6 py-4 text-white",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold font-cairo-play",children:"خط زمني للطلب"}),r.jsxs("p",{className:"text-sm opacity-90 font-cairo-play",children:[C.trackingNumber," - ",(B=C.receiver)==null?void 0:B.fullName]})]}),r.jsx("button",{onClick:v,className:"text-white hover:text-gray-200 transition-colors",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),r.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:r.jsx(Jt,{items:j,variant:"default",className:"space-y-4"})})]})})},Se=u=>({ready_for_pickup:"جاهز للاستلام",picked_up:"تم الاستلام",in_transit:"في الطريق",out_for_delivery:"خارج للتوصيل",delivered:"تم التوصيل",returned:"تم الإرجاع",failed:"فشل في التوصيل"})[u]||u,Je=u=>({ready_for_pickup:"الطلب جاهز للاستلام من المرسل",picked_up:"تم استلام الطلب بنجاح",in_transit:"الطلب في الطريق إلى وجهته",out_for_delivery:"الطلب خارج للتوصيل للمستلم",delivered:"تم توصيل الطلب بنجاح",returned:"تم إرجاع الطلب",failed:"فشل في توصيل الطلب"})[u]||"",Qe=u=>({received:"استلام الطلب",start_maintenance:"بدء الصيانة",fail_maintenance:"فشل في الصيانة",reschedule:"إعادة للصيانة",complete_maintenance:"إنجاز الصيانة",send_order:"إرسال الطلب",confirm_send:"تأكيد إرسال الطلب"})[u]||u,Ke=u=>({received:"completed",start_maintenance:"processing",fail_maintenance:"failed",reschedule:"pending",complete_maintenance:"completed",send_order:"shipping",confirm_send:"shipping"})[u]||"pending",Ge=()=>r.jsxs("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-brand-red-500 via-brand-red-600 to-brand-red-700 rounded-xl shadow-brand-red relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),r.jsxs("svg",{className:"w-7 h-7 text-white relative z-10",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[r.jsx("path",{d:"M6 8h2v8H6V8zm4 0h2v8h-2V8zm4 0h2v8h-2V8z",fill:"currentColor"}),r.jsx("path",{d:"M4 6h16M4 18h16M8 4v16M16 4v16M8 4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",stroke:"currentColor",strokeWidth:"0.5",strokeLinecap:"round"}),r.jsx("circle",{cx:"6",cy:"6",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"18",cy:"6",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"6",cy:"18",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"18",cy:"18",r:"0.5",fill:"currentColor"}),r.jsx("circle",{cx:"12",cy:"12",r:"0.5",fill:"currentColor"})]}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-red-400/20 to-transparent rounded-xl"})]});return r.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col",dir:"rtl",children:[r.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx(Ge,{}),r.jsx("div",{children:r.jsx("h1",{className:"text-xl font-bold text-gray-900 font-cairo-play",children:"ميتو الرايق للصيانة"})})]}),r.jsx("div",{className:"flex space-x-2 space-x-reverse",children:M.map(u=>{const v=U===u.id,C=u.badge&&u.badge!=="0",j=K(u.color);return r.jsxs("button",{onClick:()=>{U!==u.id&&fe(u.id)},className:`
                      px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200
                      flex items-center space-x-2 space-x-reverse font-cairo
                      ${v?j.active:j.inactive}
                      ${Te&&U===u.id?"opacity-70":""}
                    `,disabled:Te&&U===u.id,children:[r.jsx("span",{children:u.label}),C&&r.jsx("span",{className:`
                        px-2 py-0.5 rounded-full text-xs font-bold transition-colors font-cairo
                        ${v?j.badgeActive:j.badge}
                      `,children:u.badge}),Te&&U===u.id&&r.jsx("div",{className:"w-3 h-3 border border-gray-400 border-t-transparent rounded-full animate-spin"})]},u.id)})}),r.jsx("div",{className:"flex items-center space-x-3 space-x-reverse",children:r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("div",{className:`w-2 h-2 rounded-full transition-colors duration-300 ${t.isInitializing?"bg-yellow-500 animate-pulse":t.isProcessing?"bg-blue-500 animate-pulse":t.isScanning?"bg-green-500":t.error?"bg-red-500":"bg-gray-400"}`}),r.jsx("span",{className:"text-xs text-gray-600 font-cairo-play",children:t.isInitializing?"جاري التشغيل...":t.isProcessing?"جاري المعالجة...":t.isScanning?"نشط":t.error?"خطأ":"متوقف"})]})})]})}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsxs("div",{className:"w-72 bg-white border-l border-gray-200 flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-gray-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-900 font-cairo-play",children:"مسح رمز التتبع"}),r.jsx("button",{onClick:P,className:`
                  px-2 py-1 rounded text-xs font-cairo-play transition-colors
                  ${t.showCamera?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}
                `,children:t.showCamera?"إخفاء الكاميرا":"إظهار الكاميرا"})]}),t.showCamera&&r.jsx("div",{className:"relative mb-3",children:r.jsxs("div",{className:"aspect-video bg-gray-900 rounded-lg overflow-hidden",children:[r.jsx("video",{ref:Oe,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("div",{className:"relative",children:r.jsxs("div",{className:"w-24 h-24 border-2 border-white/50 rounded relative",children:[r.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 border-t-2 border-r-2 border-blue-400 rounded-tr"}),r.jsx("div",{className:"absolute -top-1 -left-1 w-3 h-3 border-t-2 border-l-2 border-blue-400 rounded-tl"}),r.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 border-b-2 border-r-2 border-blue-400 rounded-br"}),r.jsx("div",{className:"absolute -bottom-1 -left-1 w-3 h-3 border-b-2 border-l-2 border-blue-400 rounded-bl"}),t.isScanning&&!t.isProcessing&&r.jsx("div",{className:"absolute inset-x-0 top-0 h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent animate-bounce"}),t.isProcessing&&r.jsx("div",{className:"absolute inset-0 bg-green-400/20 border-2 border-green-400 rounded animate-pulse",children:r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("div",{className:"bg-green-500 text-white px-2 py-1 rounded text-xs font-cairo-play",children:"✓"})})}),t.isProcessing&&r.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-2 py-1 rounded text-xs font-cairo-play animate-pulse",children:"جاري المعالجة..."}),!t.isProcessing&&t.isScanning&&r.jsx("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-2 py-1 rounded text-xs font-cairo-play",children:"جاهز للمسح"})]})})}),!t.isScanning&&!t.error&&!t.isInitializing&&r.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:r.jsx("button",{onClick:$,className:"px-3 py-1 bg-blue-600 text-white rounded text-xs font-cairo-play hover:bg-blue-700 transition-colors",children:"بدء المسح"})}),t.isInitializing&&r.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),r.jsx("span",{className:"text-white text-xs font-cairo-play",children:"جاري تشغيل الكاميرا..."})]})}),t.isScanning&&r.jsx("div",{className:"absolute bottom-2 left-2 right-2",children:r.jsx("div",{className:"bg-black/70 rounded p-1 text-center",children:r.jsx("p",{className:"text-white text-xs font-cairo-play",children:t.isProcessing?"جاري جلب البيانات من بوسطة...":"امسح رمز QR"})})})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("form",{onSubmit:qe,className:"space-y-2",children:[r.jsx("input",{type:"text",value:a,onChange:u=>o(u.target.value),placeholder:"أدخل رقم التتبع...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm font-cairo text-right",dir:"rtl"}),r.jsx("button",{type:"submit",disabled:!a.trim()||ae,className:"w-full py-2 bg-blue-600 text-white rounded-lg text-sm font-cairo-play disabled:bg-gray-300",children:ae?"جاري البحث...":"بحث عن الطلب"})]}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[r.jsx("span",{className:"font-cairo-play",children:"جهاز المسح الضوئي:"}),r.jsxs("div",{className:"flex items-center space-x-1 space-x-reverse",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${h?"bg-green-500 animate-pulse":"bg-gray-300"}`}),r.jsx("span",{className:"font-cairo-play",children:h?"نشط":"جاهز"})]})]})]}),t.error&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 mt-2",children:r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[r.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),r.jsx("p",{className:"text-red-700 font-cairo-play text-right text-xs flex-1",children:t.error}),r.jsx("button",{onClick:()=>{e(u=>({...u,error:null})),S.current&&typeof S.current.resume=="function"&&S.current.resume()},className:"text-red-600 hover:text-red-800 text-xs font-cairo-play underline",children:"إعادة المحاولة"})]})})]}),r.jsxs("div",{className:"flex-1 p-4 overflow-y-auto scrollbar-hide",children:[r.jsxs("h4",{className:"text-sm font-semibold text-gray-900 mb-3 font-cairo-play",children:["آخر المسح (",f.length,")"]}),r.jsx("div",{className:"space-y-2",children:f.length>0?f.slice(0,8).map(u=>{var v,C,j;return r.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-2 hover:bg-gray-100 transition-colors duration-200",children:[r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse flex-1 min-w-0",children:[r.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium text-gray-900 text-xs font-cairo-play truncate mb-1",children:u.trackingNumber}),r.jsx("p",{className:"text-gray-600 text-xs font-cairo-play truncate",children:((v=u.receiver)==null?void 0:v.fullName)||"غير محدد"}),((j=(C=u.specs)==null?void 0:C.packageDetails)==null?void 0:j.description)&&r.jsx("p",{className:"text-gray-500 text-xs font-cairo-play truncate max-w-xs",children:u.specs.packageDetails.description})]})]}),r.jsx("span",{className:"text-xs text-gray-500 font-cairo-play flex-shrink-0 mr-2",children:u.scannedAt?bt(u.scannedAt):"لا يوجد وقت"})]},u._id)}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:r.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),r.jsx("p",{className:"text-gray-500 text-sm font-cairo-play",children:"لا توجد عمليات مسح حديثة"})]})})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsx("div",{className:"bg-white border-b border-gray-100 px-6 py-3",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-lg font-bold text-gray-900 font-cairo-play",children:(Ae=M.find(u=>u.id===U))==null?void 0:Ae.label}),r.jsxs("span",{className:"text-sm text-gray-600 font-cairo-play",children:[((Me=_e[U])==null?void 0:Me.length)||0," طلب"]})]})}),c&&s&&r.jsx("div",{className:`bg-gradient-to-r border-b p-3 ${i(s)?"from-orange-50 to-red-50 border-orange-200":"from-green-50 to-emerald-50 border-green-200"}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse flex-1",children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${i(s)?"bg-orange-100":"bg-green-100"}`,children:r.jsx("svg",{className:`w-4 h-4 ${i(s)?"text-orange-600":"text-green-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i(s)?r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"}):r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs("div",{className:"flex items-center space-x-6 space-x-reverse",children:[r.jsx("div",{className:"flex items-center space-x-3 space-x-reverse flex-shrink-0",children:r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"font-bold text-gray-900 text-xs font-cairo-play mb-1",children:"رقم التتبع"}),r.jsx("span",{className:"text-gray-900 text-md font-bold font-cairo-play truncate max-w-32",children:s.trackingNumber})]})}),r.jsx("div",{className:"w-px h-12 bg-gradient-to-b from-gray-200 to-gray-300 flex-shrink-0"}),r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse flex-shrink-0",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-sm",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),r.jsxs("div",{className:"min-w-0 max-w-32",children:[r.jsx("p",{className:"font-bold text-gray-900 text-xs font-cairo-play mb-1",children:"العميل"}),r.jsx("span",{className:"text-gray-700 text-sm font-small font-cairo-play truncate max-w-full",children:((De=s.receiver)==null?void 0:De.fullName)||"غير محدد"})]})]}),r.jsx("div",{className:"w-px h-12 bg-gradient-to-b from-gray-200 to-gray-300 flex-shrink-0"}),r.jsxs("div",{className:"flex items-start space-x-3 space-x-reverse flex-1 min-w-0",children:[r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center shadow-sm flex-shrink-0 mt-0.5",children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-bold text-gray-900 text-xs font-cairo-play mb-1",children:"وصف المنتج"}),r.jsx("span",{className:"text-gray-700 text-sm font-small font-cairo-play line-clamp-2 break-words",children:(($e=(Pe=s.specs)==null?void 0:Pe.packageDetails)==null?void 0:$e.description)||"لا يوجد وصف للمنتج"})]})]})]})})]}),r.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse flex-shrink-0",children:[r.jsx("button",{onClick:me,className:"px-4 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-cairo-play transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2","aria-label":"تأكيد استلام الطلب",children:"تأكيد (Enter)"}),r.jsx("button",{onClick:()=>{n(null),l(!1),S.current&&typeof S.current.resume=="function"&&S.current.resume()},className:"px-3 py-1.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg text-sm font-cairo-play transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2","aria-label":"إلغاء استلام الطلب",children:"إلغاء"})]})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:Te?r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("span",{className:"text-gray-600 font-cairo-play",children:"جاري تحميل الطلبات..."})]})}):((Be=_e[U])==null?void 0:Be.length)>0?r.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:_e[U].map(u=>r.jsx(Nr,{order:u,onAction:ce,showTimeline:!1,onShowTimeline:v=>{T(v),w(!0)},className:`text-sm transition-all duration-500 ease-out transform ${L===u._id?`${O(U)} scale-[1.02]`:""} ${ge?"opacity-75":""}`,disabled:ge},u._id))}):r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 font-cairo-play",children:"لا توجد طلبات"}),r.jsx("p",{className:"text-gray-600 font-cairo-play",children:"لا توجد طلبات في هذه المرحلة حالياً"})]})})]})]}),r.jsx(le,{isOpen:x,onClose:()=>{w(!1),T(null)},order:b}),r.jsx("input",{ref:We,type:"text",className:"absolute opacity-0 pointer-events-none",autoFocus:!0,onKeyPress:be})]})};export{Tn as default};
